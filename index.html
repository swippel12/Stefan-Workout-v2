<!DOCTYPE html><html lang="en"><head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="12M Training">
<meta name="theme-color" content="#0a0a0a">
<title>Stefan Workout</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;600;700;900&family=Barlow:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root{--bg:#0a0a0a;--surface:#141414;--surface2:#1e1e1e;--surface3:#282828;--border:#2a2a2a;--text:#f0f0f0;--text-dim:#888;--text-muted:#555;--accent:#e8ff00;--accent-dim:#b5c700;--red:#ff4444;--green:#44ff88;--phase1:#e8ff00;--phase2:#ff8c00;--phase3:#00d4ff;--bc:'Barlow Condensed',sans-serif;--b:'Barlow',sans-serif;--sat:env(safe-area-inset-top, 44px);--sab:env(safe-area-inset-bottom, 16px)}
  *{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
  html,body{height:100%;background:var(--bg);color:var(--text);font-family:var(--b);overflow:hidden}
  .screen{position:absolute;inset:0;display:none;flex-direction:column;overflow:hidden;pointer-events:none}
  .screen.active{display:flex;animation:fadeIn .2s ease;pointer-events:auto}
  #workout-screen{position:absolute;top:0;left:0;right:0;bottom:calc(44px + var(--sab));display:none;flex-direction:column;overflow:hidden;background:var(--bg)}
  #workout-screen.active{display:flex}
  #workout-screen.active ~ #bottom-nav{display:flex}
  #setup-screen{align-items:center;justify-content:center;padding:32px 28px;padding-bottom:calc(32px + var(--sab));background:linear-gradient(160deg,#0a0a0a 0%,#111 100%);z-index:50}
  .setup-logo{font-family:var(--bc);font-size:64px;font-weight:900;line-height:.9;letter-spacing:-2px;color:var(--accent);text-align:center;margin-bottom:10px}
  .setup-sub{font-family:var(--bc);font-size:14px;font-weight:600;letter-spacing:4px;color:var(--text-dim);text-transform:uppercase;text-align:center;margin-bottom:48px}
  .setup-label{font-family:var(--bc);font-size:12px;font-weight:700;letter-spacing:3px;color:var(--text-dim);text-transform:uppercase;margin-bottom:8px;align-self:flex-start;width:100%}
  .setup-input{width:100%;background:var(--surface2);border:1px solid var(--border);color:var(--text);font-family:var(--b);font-size:16px;padding:14px 16px;border-radius:6px;margin-bottom:28px;-webkit-appearance:none}
  .setup-input:focus{outline:none;border-color:var(--accent)}
  .btn-primary{width:100%;background:var(--accent);color:#000;font-family:var(--bc);font-size:18px;font-weight:900;letter-spacing:2px;text-transform:uppercase;padding:16px;border:none;border-radius:6px;cursor:pointer;transition:opacity .15s;position:relative;z-index:51;-webkit-appearance:none;touch-action:manipulation}
  .btn-primary:active{opacity:.8}
  #home-screen{background:var(--bg)}
  .home-header{padding:calc(var(--sat) + 8px) 20px 16px;border-bottom:1px solid var(--border);flex-shrink:0}
  .home-phase-label{font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:4px;text-transform:uppercase;margin-bottom:4px}
  .home-title{font-family:var(--bc);font-size:40px;font-weight:900;line-height:1;letter-spacing:-1px}
  .home-meta{font-size:13px;color:var(--text-dim);margin-top:4px}
  .home-week-strip{display:flex;gap:5px;padding:16px 20px 0;flex-shrink:0}
  .week-pip{flex:1;height:4px;border-radius:2px;background:var(--surface3);transition:background .3s}
  .week-pip.done{background:var(--accent-dim)}
  .week-pip.current{background:var(--accent)}
  .home-content{flex:1;overflow-y:auto;padding:16px 20px 80px}
  .deload-banner{background:var(--surface2);border:1px solid #ff8c0044;border-radius:8px;padding:12px 14px;margin-bottom:16px;display:flex;align-items:center;gap:10px}
  .deload-dot{width:7px;height:7px;border-radius:50%;background:#ff8c00;flex-shrink:0}
  .deload-text{font-size:12px;color:#ff8c00;font-weight:500}
  .section-label{font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:4px;color:var(--text-muted);text-transform:uppercase;margin-bottom:10px}
  .day-cards{display:flex;flex-direction:column;gap:8px;margin-bottom:24px}
  .day-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:15px 16px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:border-color .15s,background .15s;position:relative;overflow:hidden}
  .day-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--accent)}
  .day-card.bonus::before{background:var(--text-muted)}
  .day-card:active{background:var(--surface2);border-color:var(--accent)}
  .day-card-tag{font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:3px;color:var(--text-dim);text-transform:uppercase;margin-bottom:3px}
  .day-card-name{font-family:var(--bc);font-size:20px;font-weight:700}
  .day-card-count{font-size:12px;color:var(--text-dim);margin-top:2px}
  .day-card-arrow{font-size:20px;color:var(--text-muted)}
  .day-card.completed{border-color:var(--surface3);opacity:.6}
  .day-card.completed::before{background:var(--green)}
  .day-card-undo{font-size:11px;font-family:var(--bc);font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--text-muted);background:var(--surface3);border:none;border-radius:4px;padding:5px 10px;cursor:pointer;white-space:nowrap;flex-shrink:0;transition:color .15s,background .15s}
  .day-card-undo:active{color:var(--text);background:var(--surface2)}
  .benchmark-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:15px 16px;cursor:pointer;transition:border-color .15s}
  .benchmark-card:active{border-color:var(--accent)}
  .benchmark-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  .benchmark-card-title{font-family:var(--bc);font-size:17px;font-weight:700}
  .benchmark-mini-grid{display:grid;grid-template-columns:1fr 1fr;gap:7px}
  .benchmark-mini-label{font-size:10px;color:var(--text-muted);margin-bottom:2px}
  .benchmark-mini-val{font-family:var(--bc);font-size:16px;font-weight:700;color:var(--text-dim)}
  .benchmark-mini-val.filled{color:var(--accent)}
  .workout-header{padding:calc(var(--sat) + 8px) 20px 14px;border-bottom:1px solid var(--border);flex-shrink:0}
  .workout-back{font-size:15px;cursor:pointer;display:flex;align-items:center;gap:5px;margin-bottom:10px;background:none;border:none;color:var(--text-dim);font-family:var(--b);padding:10px 14px 10px 0;min-height:44px;min-width:44px;transition:color .15s}
  .workout-back:active{color:var(--text)}
  .workout-day-tag{font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:4px;color:var(--accent);text-transform:uppercase;margin-bottom:3px}
  .workout-title{font-family:var(--bc);font-size:30px;font-weight:900;line-height:1}
  .workout-progress-bar{height:3px;background:var(--surface3);margin-top:14px;border-radius:2px;overflow:hidden}
  .workout-progress-fill{height:100%;background:var(--accent);border-radius:2px;transition:width .4s ease}
  .workout-content{flex:1;overflow-y:auto;padding:0 20px 20px;-webkit-overflow-scrolling:touch}
  .top-progress-track{height:6px;background:var(--surface3);border-radius:3px;overflow:hidden}
  .top-progress-fill{height:100%;background:var(--accent);border-radius:3px;transition:width .35s ease;width:0%}
  .top-progress-label{font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:2px;color:var(--text-muted);text-transform:uppercase;text-align:right;margin-top:5px;margin-bottom:2px}
  .timer-bar{display:flex;align-items:center;justify-content:space-between;padding:8px 20px;background:var(--surface);border-bottom:1px solid var(--border);flex-shrink:0}
  .timer-display{font-family:var(--bc);font-size:24px;font-weight:900;color:var(--accent);letter-spacing:2px}
  .timer-controls{display:flex;gap:8px}
  .timer-btn{background:var(--surface3);border:1px solid var(--border);color:var(--text);font-family:var(--bc);font-size:12px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:8px 14px;border-radius:6px;cursor:pointer;transition:background .15s,border-color .15s,transform .1s}
  .timer-btn:active{background:var(--surface2);transform:scale(0.93)}
  .timer-btn.running{border-color:var(--accent);color:var(--accent)}
  .timer-btn.paused{border-color:var(--phase2);color:var(--phase2)}
  .exercise-item{border-bottom:1px solid var(--border);padding:16px 0}
  .exercise-item:last-child{border-bottom:none}
  .exercise-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px}
  .exercise-name{font-family:var(--bc);font-size:26px;font-weight:900;line-height:1.1;flex:1;padding-right:10px;color:#fff;letter-spacing:-0.5px;text-transform:uppercase;cursor:pointer;-webkit-tap-highlight-color:rgba(232,255,0,0.1)}
  .exercise-name:active{color:var(--accent)}
  .exercise-superset-tag{font-size:9px;font-weight:700;letter-spacing:2px;color:var(--phase3);border:1px solid var(--phase3);padding:2px 6px;border-radius:3px;text-transform:uppercase;white-space:nowrap;margin-top:5px}
  .exercise-specs{display:flex;gap:14px;margin-bottom:8px}
  .spec-label{font-size:9px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase}
  .spec-val{font-family:var(--bc);font-size:16px;font-weight:600}
  .exercise-note{font-size:12px;color:var(--text-dim);line-height:1.5;background:var(--surface2);border-radius:6px;padding:8px 10px;margin-bottom:12px}
  .exercise-note.superset-note{border-left:2px solid var(--phase3)}
  .last-weight-hint{font-size:11px;color:var(--text-muted);margin-bottom:8px;line-height:1.6}
  .last-weight-hint span{color:var(--accent-dim);font-weight:600}
  .log-sets{display:flex;flex-direction:column;gap:7px}
  .log-set-row{display:flex;align-items:center;gap:8px}
  .set-num{font-family:var(--bc);font-size:12px;font-weight:700;color:var(--text-muted);width:22px;flex-shrink:0;text-align:center}
  .log-input-wrap{flex:1;position:relative}
  .log-input-label{font-size:8px;letter-spacing:2px;color:var(--text-muted);text-transform:uppercase;position:absolute;top:5px;left:10px}
  .log-input{width:100%;background:var(--surface2);border:1px solid var(--border);border-radius:6px;padding:19px 10px 6px;color:var(--text);font-family:var(--bc);font-size:20px;font-weight:700;text-align:center;-webkit-appearance:none;-moz-appearance:textfield;transition:border-color .15s}
  .log-input:focus{outline:none;border-color:var(--accent)}
  .log-input.filled{border-color:var(--surface3);color:var(--accent)}
  .log-input::-webkit-inner-spin-button,.log-input::-webkit-outer-spin-button{-webkit-appearance:none}
  .rpe-select{width:70px;background:var(--surface2);border:1px solid var(--border);border-radius:6px;padding:19px 6px 6px;color:var(--text);font-family:var(--bc);font-size:20px;font-weight:700;text-align:center;-webkit-appearance:none;transition:border-color .15s;flex-shrink:0}
  .rpe-wrap{position:relative;flex-shrink:0;width:70px}
  .rpe-wrap .log-input-label{z-index:1}
  .rpe-select:focus{outline:none;border-color:var(--accent)}
  .rpe-select.filled{border-color:var(--surface3);color:var(--accent)}
  .set-check{width:30px;height:30px;border-radius:50%;background:var(--surface3);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:14px;transition:background .2s}
  .set-check.done{background:var(--accent)}
  .workout-footer{padding:14px 20px 16px;border-top:1px solid var(--border);flex-shrink:0;background:var(--bg)}
  .btn-done{width:100%;background:transparent;color:var(--text);font-family:var(--bc);font-size:18px;font-weight:900;letter-spacing:2px;text-transform:uppercase;padding:16px;border:1px solid #444;border-radius:6px;cursor:pointer;transition:all .2s}
  .btn-done.ready{background:var(--accent);color:#000;border-color:var(--accent)}
  .btn-done:active{opacity:.8}
  #complete-screen{align-items:center;justify-content:center;padding:32px 28px;background:var(--bg)}
  .complete-icon{font-size:56px;margin-bottom:20px}
  .complete-title{font-family:var(--bc);font-size:48px;font-weight:900;color:var(--accent);text-align:center;line-height:1;margin-bottom:6px}
  .complete-sub{font-size:14px;color:var(--text-dim);text-align:center;margin-bottom:32px}
  .complete-stats{width:100%;display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:32px}
  .complete-stat{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:14px;text-align:center}
  .complete-stat-val{font-family:var(--bc);font-size:28px;font-weight:900;color:var(--accent)}
  .complete-stat-label{font-size:10px;color:var(--text-muted);letter-spacing:2px;text-transform:uppercase;margin-top:3px}
  #benchmark-screen{background:var(--bg)}
  .benchmark-header{padding:calc(var(--sat) + 8px) 20px 16px;border-bottom:1px solid var(--border);flex-shrink:0}
  .benchmark-content{flex:1;overflow-y:auto;padding:16px 20px 80px}
  .benchmark-lift{border-bottom:1px solid var(--border);padding:16px 0}
  .benchmark-lift:last-child{border-bottom:none}
  .benchmark-lift-name{font-family:var(--bc);font-size:18px;font-weight:700;margin-bottom:12px}
  .benchmark-phases{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:6px}
  .bpc-label{font-size:9px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:5px}
  .bpc-input{width:100%;background:var(--surface2);border:1px solid var(--border);border-radius:6px;padding:8px 4px;color:var(--text);font-family:var(--bc);font-size:18px;font-weight:700;text-align:center;-webkit-appearance:none;-moz-appearance:textfield}
  .bpc-input:focus{outline:none;border-color:var(--accent)}
  .bpc-input::-webkit-inner-spin-button,.bpc-input::-webkit-outer-spin-button{-webkit-appearance:none}
  .bpc-input.filled{color:var(--accent);border-color:var(--surface3)}
  .bpc-delta{font-size:10px;text-align:center;margin-top:3px;font-weight:600;color:var(--green)}
  #history-screen{background:var(--bg)}
  .history-header{padding:calc(var(--sat) + 8px) 20px 16px;border-bottom:1px solid var(--border);flex-shrink:0}
  .history-content{flex:1;overflow-y:auto;padding:16px 20px 80px}
  .history-session{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:14px 16px;margin-bottom:10px;cursor:pointer;transition:border-color .15s,background .15s}
  .history-session:active{background:var(--surface2);border-color:var(--accent)}
  .history-session-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
  .history-session-title{font-family:var(--bc);font-size:17px;font-weight:700}
  .history-session-date{font-size:11px;color:var(--text-dim)}
  .history-exercise-row{display:flex;justify-content:space-between;padding:4px 0;border-top:1px solid var(--border)}
  .history-ex-name{font-size:12px;color:var(--text-dim)}
  .history-ex-vals{font-size:12px;color:var(--accent-dim);font-weight:600}
  .bottom-nav{position:fixed;bottom:0;left:0;right:0;background:var(--bg);border-top:1px solid var(--border);display:none;padding:8px 0 0;padding-bottom:var(--sab);z-index:100}
  .bottom-nav.visible{display:flex}
  .nav-items{display:flex;width:100%}
  .nav-item{flex:1;display:flex;flex-direction:column;align-items:center;gap:3px;cursor:pointer;padding:3px 0;background:none;border:none;color:var(--text-muted);font-family:var(--b);font-size:9px;letter-spacing:1px;text-transform:uppercase;transition:color .15s}
  .nav-item.active{color:var(--accent)}
  .nav-icon{font-size:20px}
  .phase-1{color:var(--phase1)}.phase-2{color:var(--phase2)}.phase-3{color:var(--phase3)}
  ::-webkit-scrollbar{width:0}
  @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
  .empty-state{text-align:center;padding:48px 16px}
  .empty-state-icon{font-size:40px;margin-bottom:14px}
  .empty-state-text{font-size:14px;color:var(--text-muted)}
  #plan-screen{background:var(--bg)}
  .plan-header{padding:calc(var(--sat) + 8px) 20px 16px;border-bottom:1px solid var(--border);flex-shrink:0;display:flex;align-items:flex-end;justify-content:space-between}
  .plan-back-btn{font-size:13px;cursor:pointer;background:none;border:none;color:var(--text-dim);font-family:var(--b);padding:0;margin-bottom:6px;display:block}
  .plan-back-btn:active{color:var(--text)}
  .plan-screen-tag{font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:4px;color:var(--text-muted);text-transform:uppercase;margin-bottom:3px}
  .plan-screen-title{font-family:var(--bc);font-size:32px;font-weight:900;line-height:1}
  .plan-content{flex:1;overflow-y:auto;padding:16px 20px 90px}
  .phase-block{margin-bottom:28px}
  .phase-block-header{display:flex;align-items:center;gap:10px;margin-bottom:12px}
  .phase-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0}
  .phase-block-title{font-family:var(--bc);font-size:13px;font-weight:700;letter-spacing:3px;text-transform:uppercase}
  .month-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .month-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:14px 16px;cursor:pointer;transition:border-color .15s,background .15s;position:relative;overflow:hidden}
  .month-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px}
  .month-card.phase-1-card::before{background:var(--phase1)}
  .month-card.phase-2-card::before{background:var(--phase2)}
  .month-card.phase-3-card::before{background:var(--phase3)}
  .month-card:active{background:var(--surface2)}
  .month-card-num{font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase;margin-bottom:3px}
  .month-card-name{font-family:var(--bc);font-size:18px;font-weight:700;line-height:1.1}
  .month-card-arrow{font-size:13px;color:var(--text-muted);margin-top:6px}
  .week-block{background:var(--surface);border:1px solid var(--border);border-radius:10px;margin-bottom:12px;overflow:hidden}
  .week-block-header{padding:14px 16px;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:background .15s}
  .week-block-header:active{background:var(--surface2)}
  .week-block-title{font-family:var(--bc);font-size:17px;font-weight:700}
  .week-block-meta{font-size:11px;color:var(--text-muted);margin-top:2px}
  .week-block-chevron{font-size:16px;color:var(--text-muted);transition:transform .2s}
  .week-block-chevron.open{transform:rotate(90deg)}
  .week-block-body{display:none;border-top:1px solid var(--border)}
  .week-block-body.open{display:block}
  .day-tab-strip{display:flex;border-bottom:1px solid var(--border)}
  .day-tab{flex:1;padding:10px 0;text-align:center;font-family:var(--bc);font-size:13px;font-weight:700;letter-spacing:2px;color:var(--text-muted);cursor:pointer;border-bottom:2px solid transparent;transition:color .15s,border-color .15s}
  .day-tab.active{color:var(--accent);border-bottom-color:var(--accent)}
  .day-panel{display:none;padding:14px 16px}
  .day-panel.active{display:block}
  .plan-exercise-row{padding:10px 0;border-bottom:1px solid var(--border);display:flex;flex-direction:column;gap:4px}
  .plan-exercise-row:last-child{border-bottom:none}
  .plan-ex-name{font-family:var(--bc);font-size:17px;font-weight:700;display:flex;align-items:center;gap:8px}
  .plan-ex-ss{font-size:9px;font-weight:700;letter-spacing:2px;color:var(--phase3);border:1px solid var(--phase3);padding:2px 5px;border-radius:3px;text-transform:uppercase}
  .plan-ex-specs{display:flex;gap:16px;margin-top:2px}
  .plan-ex-spec{display:flex;flex-direction:column}
  .plan-ex-spec-label{font-size:9px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase}
  .plan-ex-spec-val{font-family:var(--bc);font-size:15px;font-weight:600}
  .plan-ex-note{font-size:11px;color:var(--text-dim);margin-top:4px;line-height:1.4}
  .plan-progress-wrap{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:24px}
  .plan-progress-top{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:10px}
  .plan-progress-title{font-family:var(--bc);font-size:15px;font-weight:700}
  .plan-progress-count{font-family:var(--bc);font-size:13px;color:var(--text-dim)}
  .plan-overall-track{height:8px;background:var(--surface3);border-radius:4px;overflow:hidden;margin-bottom:14px}
  .plan-overall-fill{height:100%;background:var(--accent);border-radius:4px;transition:width .4s ease}
  .plan-phase-rows{display:flex;flex-direction:column;gap:8px}
  .plan-phase-row{display:flex;align-items:center;gap:10px}
  .plan-phase-row-label{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;width:60px;flex-shrink:0}
  .plan-phase-mini-track{flex:1;height:5px;background:var(--surface3);border-radius:3px;overflow:hidden}
  .plan-phase-mini-fill{height:100%;border-radius:3px;transition:width .4s ease}
  .plan-phase-row-count{font-family:var(--bc);font-size:12px;color:var(--text-muted);width:36px;text-align:right;flex-shrink:0}
  #weight-screen{background:var(--bg)}
  .weight-header{padding:calc(var(--sat) + 8px) 20px 16px;border-bottom:1px solid var(--border);flex-shrink:0}
  .weight-content{flex:1;overflow-y:auto;padding:16px 20px 90px}
  .weight-log-form{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:20px}
  .weight-form-row{display:flex;gap:10px;align-items:flex-end}
  .weight-form-group{flex:1;display:flex;flex-direction:column;gap:6px}
  .weight-form-label{font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:var(--text-muted)}
  .weight-form-input{background:var(--surface2);border:1px solid var(--border);border-radius:6px;padding:12px 14px;color:var(--text);font-family:var(--bc);font-size:22px;font-weight:700;width:100%;-webkit-appearance:none;-moz-appearance:textfield;transition:border-color .15s}
  .weight-form-input:focus{outline:none;border-color:var(--accent)}
  .weight-form-input::-webkit-inner-spin-button,.weight-form-input::-webkit-outer-spin-button{-webkit-appearance:none}
  .btn-log-weight{background:var(--accent);color:#000;font-family:var(--bc);font-size:15px;font-weight:900;letter-spacing:2px;text-transform:uppercase;padding:12px 18px;border:none;border-radius:6px;cursor:pointer;flex-shrink:0;transition:opacity .15s;white-space:nowrap}
  .btn-log-weight:active{opacity:.8}
  .weight-chart-wrap{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:20px}
  .weight-chart-title{font-family:var(--bc);font-size:15px;font-weight:700;margin-bottom:4px}
  .weight-chart-sub{font-size:11px;color:var(--text-muted);margin-bottom:14px}
  .weight-chart-stats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:16px}
  .wcs{background:var(--surface2);border-radius:6px;padding:10px;text-align:center}
  .wcs-val{font-family:var(--bc);font-size:22px;font-weight:900;color:var(--accent)}
  .wcs-label{font-size:9px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase;margin-top:2px}
  canvas#weight-chart{width:100%;display:block;border-radius:4px}
  .weight-log-list{display:flex;flex-direction:column;gap:0}
  .weight-log-item{display:flex;justify-content:space-between;align-items:center;padding:11px 0;border-bottom:1px solid var(--border)}
  .weight-log-item:last-child{border-bottom:none}
  .weight-log-date{font-size:13px;color:var(--text-dim)}
  .weight-log-val{font-family:var(--bc);font-size:20px;font-weight:700;color:var(--accent)}
  .weight-log-delta{font-size:11px;font-weight:600;margin-left:6px}
  .weight-log-delete{background:none;border:none;color:var(--text-muted);font-size:16px;cursor:pointer;padding:4px 8px}
  .weight-log-delete:active{color:var(--red)}
  .weight-section-label{font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:4px;color:var(--text-muted);text-transform:uppercase;margin-bottom:10px}
  .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:999;display:none;align-items:center;justify-content:center;padding:24px}
  .modal-overlay.active{display:flex}
  .modal{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:24px;width:100%;max-width:320px}
  .modal-title{font-family:var(--bc);font-size:22px;font-weight:900;margin-bottom:8px}
  .modal-body{font-size:14px;color:var(--text-dim);line-height:1.5;margin-bottom:24px}
  .modal-buttons{display:flex;gap:10px}
  .modal-btn{flex:1;padding:14px;border:none;border-radius:8px;font-family:var(--bc);font-size:16px;font-weight:900;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:opacity .15s}
  .modal-btn:active{opacity:.8}
  .modal-btn-cancel{background:var(--surface3);color:var(--text-dim)}
  .modal-btn-confirm{background:var(--accent);color:#000}
  #settings-screen{background:var(--bg)}
  .settings-header{padding:calc(var(--sat) + 8px) 20px 16px;border-bottom:1px solid var(--border);flex-shrink:0}
  .settings-content{flex:1;overflow-y:auto;padding:16px 20px 90px}
  .settings-section{margin-bottom:28px}
  .settings-section-label{font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:4px;color:var(--text-muted);text-transform:uppercase;margin-bottom:12px}
  .settings-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;overflow:hidden}
  .settings-row{padding:16px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border);cursor:pointer;transition:background .15s}
  .settings-row:last-child{border-bottom:none}
  .settings-row:active{background:var(--surface2)}
  .settings-row-title{font-family:var(--bc);font-size:17px;font-weight:700}
  .settings-row-sub{font-size:11px;color:var(--text-muted);margin-top:2px}
  .settings-row-icon{font-size:20px;color:var(--text-muted)}
  .settings-row.danger .settings-row-title{color:var(--red)}
  .settings-row.danger .settings-row-icon{color:var(--red)}
  .install-banner{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:20px}
  .install-banner-title{font-family:var(--bc);font-size:17px;font-weight:700;margin-bottom:6px}
  .install-banner-steps{font-size:13px;color:var(--text-dim);line-height:1.8}
  .install-banner-steps span{color:var(--accent);font-weight:600}
  .data-info{background:var(--surface2);border-radius:8px;padding:12px 14px;font-size:12px;color:var(--text-dim);line-height:1.6;margin-bottom:20px}
  .data-info strong{color:var(--text)}
  /* Add Movement Modal */
  .add-move-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:1000;display:none;flex-direction:column}
  .add-move-overlay.active{display:flex}
  .add-move-header{padding:calc(var(--sat) + 8px) 20px 12px;border-bottom:1px solid var(--border);flex-shrink:0;background:var(--bg)}
  .add-move-close{background:none;border:none;color:var(--text-dim);font-family:var(--b);font-size:15px;cursor:pointer;padding:10px 14px 10px 0;min-height:44px}
  .add-move-close:active{color:var(--text)}
  .add-move-search{width:100%;background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:12px 14px;color:var(--text);font-family:var(--b);font-size:16px;margin-top:10px;-webkit-appearance:none}
  .add-move-search:focus{outline:none;border-color:var(--accent)}
  .add-move-list{flex:1;overflow-y:auto;padding:8px 20px 40px;background:var(--bg)}
  .add-move-cat{font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase;padding:14px 0 6px}
  .add-move-item{padding:12px 0;border-bottom:1px solid var(--border);cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:background .1s}
  .add-move-item:active{background:var(--surface2)}
  .add-move-item-name{font-family:var(--bc);font-size:18px;font-weight:700}
  .add-move-item-muscles{font-size:11px;color:var(--text-dim);margin-top:2px}
  .add-move-item-arrow{color:var(--text-muted);font-size:14px}
  /* Add Movement Config */
  .add-move-config{display:none;flex-direction:column;padding:20px;background:var(--bg);flex:1}
  .add-move-config.active{display:flex}
  .add-move-config-title{font-family:var(--bc);font-size:24px;font-weight:900;text-transform:uppercase;margin-bottom:20px}
  .add-move-config-row{display:flex;gap:12px;margin-bottom:16px}
  .add-move-config-group{flex:1;display:flex;flex-direction:column;gap:6px}
  .add-move-config-label{font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:var(--text-muted)}
  .add-move-config-input{background:var(--surface2);border:1px solid var(--border);border-radius:6px;padding:12px 14px;color:var(--text);font-family:var(--bc);font-size:22px;font-weight:700;text-align:center;width:100%;-webkit-appearance:none;-moz-appearance:textfield}
  .add-move-config-input:focus{outline:none;border-color:var(--accent)}
  .add-move-config-input::-webkit-inner-spin-button,.add-move-config-input::-webkit-outer-spin-button{-webkit-appearance:none}
  .btn-add-move{width:100%;background:var(--accent);color:#000;font-family:var(--bc);font-size:18px;font-weight:900;letter-spacing:2px;text-transform:uppercase;padding:16px;border:none;border-radius:6px;cursor:pointer;margin-top:auto}
  .btn-add-move:active{opacity:.8}
  .btn-add-workout{background:var(--surface2);border:1px dashed var(--border);border-radius:10px;padding:14px;text-align:center;cursor:pointer;margin-top:8px;transition:border-color .15s,background .15s}
  .btn-add-workout:active{background:var(--surface3);border-color:var(--accent)}
  .btn-add-workout-text{font-family:var(--bc);font-size:15px;font-weight:700;color:var(--text-dim);letter-spacing:2px;text-transform:uppercase}
  /* 1km Row Tracker */
  .row-tracker{background:var(--surface);border:1px solid #00d4ff44;border-radius:10px;padding:14px 16px;margin:12px 0 4px}
  .row-tracker-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
  .row-tracker-title{font-family:var(--bc);font-size:14px;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:var(--phase3)}
  .row-tracker-time{font-family:var(--bc);font-size:40px;font-weight:900;color:var(--phase3);letter-spacing:2px;text-align:center;margin-bottom:10px}
  .row-tracker-controls{display:flex;gap:8px}
  .row-tracker-btn{flex:1;padding:12px;border:1px solid var(--border);border-radius:8px;background:var(--surface2);color:var(--text);font-family:var(--bc);font-size:14px;font-weight:900;letter-spacing:2px;text-transform:uppercase;cursor:pointer;text-align:center;transition:all .15s}
  .row-tracker-btn:active{transform:scale(0.95)}
  .row-tracker-btn.start{border-color:var(--phase3);color:var(--phase3)}
  .row-tracker-btn.stop{background:var(--phase3);color:#000;border-color:var(--phase3)}
  .row-tracker-btn.reset{border-color:var(--border);color:var(--text-muted)}
  .row-tracker-best{display:flex;justify-content:space-between;align-items:center;margin-top:10px;padding-top:10px;border-top:1px solid var(--border)}
  .row-tracker-best-label{font-size:11px;color:var(--text-muted)}
  .row-tracker-best-val{font-family:var(--bc);font-size:16px;font-weight:700;color:var(--phase3)}
  .row-tracker-saved{font-family:var(--bc);font-size:12px;font-weight:700;letter-spacing:2px;color:var(--green);text-align:center;margin-top:8px;text-transform:uppercase}
  /* Exercise History Overlay */
  .ex-history-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.9);z-index:1001;display:none;flex-direction:column}
  .ex-history-overlay.active{display:flex}
  .ex-history-header{padding:calc(var(--sat) + 8px) 20px 14px;border-bottom:1px solid var(--border);flex-shrink:0;background:var(--bg)}
  .ex-history-close{background:none;border:none;color:var(--text-dim);font-family:var(--b);font-size:15px;cursor:pointer;padding:10px 14px 10px 0;min-height:44px}
  .ex-history-close:active{color:var(--text)}
  .ex-history-title{font-family:var(--bc);font-size:24px;font-weight:900;text-transform:uppercase;margin-top:6px;line-height:1.1}
  .ex-history-content{flex:1;overflow-y:auto;padding:16px 20px 40px;background:var(--bg)}
  .ex-history-session{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:14px 16px;margin-bottom:10px}
  .ex-history-session-date{font-size:12px;color:var(--text-dim);margin-bottom:8px}
  .ex-history-set-row{display:flex;align-items:center;gap:10px;padding:5px 0;border-top:1px solid var(--border)}
  .ex-history-set-row:first-child{border-top:none}
  .ex-history-set-num{font-family:var(--bc);font-size:11px;font-weight:700;color:var(--text-muted);width:22px}
  .ex-history-set-weight{font-family:var(--bc);font-size:17px;font-weight:700;flex:1}
  .ex-history-set-rpe{font-size:11px;color:var(--text-dim);width:50px;text-align:center}
  .ex-history-set-check{font-size:13px}
  .ex-history-pr{background:var(--surface);border:1px solid var(--accent);border-radius:10px;padding:14px 16px;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center}
  .ex-history-pr-label{font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase}
  .ex-history-pr-val{font-family:var(--bc);font-size:28px;font-weight:900;color:var(--accent)}
</style>
</head>
<body>
<div id="setup-screen" class="screen active">
  <div class="setup-logo">12M</div>
  <div class="setup-sub">Training Plan</div>
  <div class="setup-label">Start Date</div>
  <input type="date" class="setup-input" id="start-date-input">
  <button class="btn-primary" id="btn-begin" onclick="setupPlan()">Begin Training</button>
</div><script>document.getElementById('start-date-input').value=new Date().toISOString().split('T')[0];</script><div id="home-screen" class="screen">
  <div class="home-header">
    <div class="home-phase-label" id="home-phase-label"></div>
    <div class="home-title" id="home-title"></div>
    <div class="home-meta" id="home-meta"></div>
  </div>
  <div class="home-week-strip" id="home-week-strip"></div>
  <div class="home-content">
    <div id="deload-banner" class="deload-banner" style="display:none">
      <div class="deload-dot"></div>
      <div class="deload-text">DELOAD WEEK â€” Reduce all loads by 40%. Active recovery.</div>
    </div>
    <div class="section-label">Today's Sessions</div>
    <div class="day-cards" id="day-cards"></div>
    <div class="section-label">Benchmarks</div>
    <div class="benchmark-card" onclick="goTo('benchmark-screen')">
      <div class="benchmark-card-header">
        <div class="benchmark-card-title">PR Tracker</div>
        <div style="font-size:16px;color:var(--text-muted)">â†’</div>
      </div>
      <div class="benchmark-mini-grid" id="benchmark-mini"></div>
    </div>
  </div>
</div><div id="workout-screen" class="screen">
  <div class="workout-header">
    <button class="workout-back" onclick="confirmExitWorkout()">â† Back</button>
    <div class="workout-day-tag" id="workout-day-tag"></div>
    <div class="workout-title" id="workout-title"></div>
    <div class="workout-progress-bar"><div class="workout-progress-fill" id="workout-progress-fill" style="width:0%"></div></div>
  </div>
  <div class="timer-bar" id="timer-bar">
    <div class="timer-display" id="timer-display">00:00</div>
    <div style="flex:1;margin:0 14px">
      <div class="top-progress-label" id="top-progress-label" style="margin:0 0 3px 0">0 / 0 SETS</div>
      <div class="top-progress-track"><div class="top-progress-fill" id="top-progress-fill"></div></div>
    </div>
    <div class="timer-controls">
      <button class="timer-btn" id="timer-toggle-btn" onclick="toggleTimer()">START</button>
      <button class="timer-btn" id="timer-reset-btn" onclick="resetTimer()">RESET</button>
    </div>
  </div>
  <div class="workout-content" id="workout-content"></div>
  <div class="workout-footer">
    <button class="btn-done" id="btn-finish-workout" onclick="finishWorkout()">FINISH WORKOUT</button>
  </div>
</div><div id="complete-screen" class="screen">
  <div class="complete-icon">âš¡</div>
  <div class="complete-title" id="complete-title">SESSION<br>DONE</div>
  <div class="complete-sub" id="complete-sub"></div>
  <div class="complete-stats" id="complete-stats"></div>
  <button class="btn-primary" onclick="resetRowTimer();goTo('home-screen')">BACK TO HOME</button>
</div><div id="benchmark-screen" class="screen">
  <div class="benchmark-header">
    <button class="workout-back" onclick="goTo('home-screen')">â† Back</button>
    <div class="workout-day-tag" style="color:var(--text-dim)">PROGRESS</div>
    <div class="workout-title">PR Tracker</div>
  </div>
  <div class="benchmark-content" id="benchmark-content"></div>
</div><div id="history-screen" class="screen">
  <div class="history-header">
    <div style="padding-top:4px"></div>
    <div class="workout-day-tag" style="color:var(--text-dim)">LOG</div>
    <div class="workout-title">Session History</div>
  </div>
  <div class="history-content" id="history-content"></div>
</div><div id="plan-screen" class="screen">
  <div class="plan-header">
    <div class="plan-header-left">
      <div class="plan-screen-tag">OVERVIEW</div>
      <div class="plan-screen-title" id="plan-screen-title">The Plan</div>
    </div>
  </div>
  <div class="plan-content" id="plan-content"></div>
</div><div id="weight-screen" class="screen">
  <div class="weight-header">
    <div class="plan-screen-tag">TRACKING</div>
    <div class="workout-title">Body Weight</div>
  </div>
  <div class="weight-content">
    <div class="weight-log-form">
      <div class="weight-form-row">
        <div class="weight-form-group">
          <div class="weight-form-label">Weight (lbs)</div>
          <input type="number" class="weight-form-input" id="weight-input" placeholder="156" step="0.1">
        </div>
        <div class="weight-form-group" style="max-width:130px">
          <div class="weight-form-label">Date</div>
          <input type="date" class="weight-form-input" id="weight-date-input" style="font-size:14px;padding:14px 10px">
        </div>
        <button class="btn-log-weight" onclick="logWeight()">LOG</button>
      </div>
    </div>
    <div class="weight-chart-wrap" id="weight-chart-wrap" style="display:none">
      <div class="weight-chart-title">Progress</div>
      <div class="weight-chart-sub" id="weight-chart-sub"></div>
      <div class="weight-chart-stats" id="weight-chart-stats"></div>
      <canvas id="weight-chart" height="180"></canvas>
    </div>
    <div class="weight-section-label" id="weight-log-label" style="display:none">History</div>
    <div class="weight-log-list" id="weight-log-list"></div>
  </div>
</div><div id="settings-screen" class="screen">
  <div class="settings-header">
    <div class="plan-screen-tag">APP</div>
    <div class="workout-title">Settings</div>
  </div>
  <div class="settings-content">
    <div class="install-banner">
      <div class="install-banner-title">ğŸ“± Add to iPhone Home Screen</div>
      <div class="install-banner-steps">
        1. Tap <span>Share â†‘</span> in Safari<br>
        2. Scroll down and tap <span>Add to Home Screen</span><br>
        3. Tap <span>Add</span> â€” done! Opens like an app.
      </div>
    </div>
    <div class="data-info">
      <strong>Your data is saved locally on this device</strong> using Safari's storage (localStorage). It persists until you clear Safari website data. Use the Export backup below to keep a copy safe.
    </div>
    <div class="settings-section">
      <div class="settings-section-label">Data & Backup</div>
      <div class="settings-card">
        <div class="settings-row" onclick="exportData()">
          <div class="settings-row-left">
            <div class="settings-row-title">Export Backup</div>
            <div class="settings-row-sub">Download all your data as a JSON file</div>
          </div>
          <div class="settings-row-icon">â†“</div>
        </div>
        <div class="settings-row" onclick="document.getElementById('import-file').click()">
          <div class="settings-row-left">
            <div class="settings-row-title">Import Backup</div>
            <div class="settings-row-sub">Restore from a previously exported file</div>
          </div>
          <div class="settings-row-icon">â†‘</div>
        </div>
        <input type="file" id="import-file" accept=".json" style="display:none" onchange="importData(event)">
      </div>
    </div>
    <div class="settings-section">
      <div class="settings-section-label">Plan</div>
      <div class="settings-card">
        <div class="settings-row" onclick="changeStartDate()">
          <div class="settings-row-left">
            <div class="settings-row-title">Change Start Date</div>
            <div class="settings-row-sub" id="settings-start-date-sub">â€”</div>
          </div>
          <div class="settings-row-icon">âœ</div>
        </div>
      </div>
    </div>
    <div class="settings-section">
      <div class="settings-section-label">Danger Zone</div>
      <div class="settings-card">
        <div class="settings-row danger" onclick="resetAllData()">
          <div class="settings-row-left">
            <div class="settings-row-title">Reset All Data</div>
            <div class="settings-row-sub">Wipe all logs, PRs, and weight entries</div>
          </div>
          <div class="settings-row-icon">âš </div>
        </div>
      </div>
    </div>
  </div>
</div><div class="modal-overlay" id="confirm-modal">
  <div class="modal">
    <div class="modal-title" id="modal-title"></div>
    <div class="modal-body" id="modal-body"></div>
    <div class="modal-buttons">
      <button class="modal-btn modal-btn-cancel" onclick="closeConfirm()">Cancel</button>
      <button class="modal-btn modal-btn-confirm" id="modal-confirm-btn" onclick="confirmAction()"></button>
    </div>
  </div>
</div><div class="add-move-overlay" id="add-move-overlay">
  <div class="add-move-header">
    <button class="add-move-close" onclick="closeAddMovement()">â† Cancel</button>
    <div style="font-family:var(--bc);font-size:22px;font-weight:900">ADD MOVEMENT</div>
    <input type="text" class="add-move-search" id="add-move-search" placeholder="Search exercises..." oninput="filterExercises(this.value)">
  </div>
  <div class="add-move-list" id="add-move-list"></div>
  <div class="add-move-config" id="add-move-config">
    <button class="add-move-close" onclick="backToExerciseList()" style="margin-bottom:10px">â† Back</button>
    <div class="add-move-config-title" id="add-move-config-title"></div>
    <div class="add-move-config-row">
      <div class="add-move-config-group">
        <div class="add-move-config-label">Sets</div>
        <input type="number" class="add-move-config-input" id="add-move-sets" value="3" min="1" max="10" onfocus="this.select()">
      </div>
      <div class="add-move-config-group">
        <div class="add-move-config-label">Target Reps</div>
        <input type="text" class="add-move-config-input" id="add-move-reps" value="10" onfocus="this.select()">
      </div>
    </div>
    <div class="add-move-config-row">
      <div class="add-move-config-group">
        <div class="add-move-config-label">Rest</div>
        <input type="text" class="add-move-config-input" id="add-move-rest" value="90s" style="font-size:18px" onfocus="this.select()">
      </div>
      <div class="add-move-config-group">
        <div class="add-move-config-label">Note (optional)</div>
        <input type="text" class="add-move-config-input" id="add-move-note" value="" placeholder="â€”" style="font-size:14px;font-weight:500" onfocus="this.select()">
      </div>
    </div>
    <button class="btn-add-move" onclick="confirmAddMovement()">ADD TO WORKOUT</button>
  </div>
</div><div class="ex-history-overlay" id="ex-history-overlay">
  <div class="ex-history-header">
    <button class="ex-history-close" onclick="closeExHistory()">â† Back</button>
    <div style="font-family:var(--bc);font-size:10px;font-weight:700;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase;margin-top:4px">EXERCISE HISTORY</div>
    <div class="ex-history-title" id="ex-history-title"></div>
  </div>
  <div class="ex-history-content" id="ex-history-content"></div>
</div><nav class="bottom-nav" id="bottom-nav">
  <div class="nav-items">
    <button class="nav-item active" id="nav-home" onclick="navTo('home-screen','nav-home')"><span class="nav-icon">âŠ</span>Home</button>
    <button class="nav-item" id="nav-plan" onclick="navTo('plan-screen','nav-plan')"><span class="nav-icon">â˜°</span>Plan</button>
    <button class="nav-item" id="nav-weight" onclick="navTo('weight-screen','nav-weight')"><span class="nav-icon">âš–</span>Weight</button>
    <button class="nav-item" id="nav-history" onclick="navTo('history-screen','nav-history')"><span class="nav-icon">â—³</span>History</button>
    <button class="nav-item" id="nav-settings" onclick="navTo('settings-screen','nav-settings')"><span class="nav-icon">âš™</span>Settings</button>
  </div>
</nav><script>
// Compressed exercise helper: [name, sets, reps, rest, note, superset?]
function E(n,s,r,re,no,ss){return{name:n,sets:s,reps:r,rest:re,note:no,superset:!!ss}}
// Compressed day helper: {name, exercises[], bonus?}
function D(n,exs,b){return{name:n,exercises:exs,bonus:!!b}}

const PLAN={months:{
1:{name:â€œFoundationâ€,days:{
A:D(â€œFull Body â€” Primaryâ€,[E(â€œBack Squatâ€,4,â€œ6â€“8â€,â€œ2 minâ€,â€œDrive knees out, stay tall, brace hardâ€),E(â€œRomanian Deadliftâ€,3,â€œ10â€,â€œ90sâ€,â€œHip hinge dominant â€” feel the hamstringsâ€),E(â€œPush Pressâ€,4,â€œ6â€“8â€,â€œ90sâ€,â€œDip, drive, press â€” use the legsâ€),E(â€œBent-Over Barbell Rowâ€,3,â€œ10â€,â€œ90sâ€,â€œChest to bar, elbows drive backâ€),E(â€œFarmerâ€™s Carryâ€,3,â€œ30mâ€,â€œ60sâ€,â€œShoulders packed, core rigid, walk tallâ€,1),E(â€œDead Bugâ€,3,â€œ8/sideâ€,â€œ60sâ€,â€œLow back glued to floor throughoutâ€)]),
B:D(â€œFull Body â€” Primaryâ€,[E(â€œTrap Bar Deadliftâ€,4,â€œ6â€“8â€,â€œ2 minâ€,â€œFull hip extension lockout at topâ€),E(â€œBulgarian Split Squatâ€,3,â€œ8/sideâ€,â€œ90sâ€,â€œFront shin vertical, drive through heelâ€),E(â€œDumbbell Bench Pressâ€,3,â€œ10â€,â€œ90sâ€,â€œFull ROM â€” touch chest, lock out topâ€),E(â€œProne Dumbbell Rowâ€,3,â€œ10â€,â€œ90sâ€,â€œChest on bench, row to hipâ€,1),E(â€œOverhead Press (strict)â€,3,â€œ8â€,â€œ90sâ€,â€œNo leg drive â€” pure shoulder strengthâ€),E(â€œPlank + Hip Tapâ€,3,â€œ30sâ€,â€œ60sâ€,â€œHips stay square â€” resist rotationâ€)]),
C:D(â€œBonus â€” Power + Accessoryâ€,[E(â€œPower Cleanâ€,4,â€œ4â€,â€œ2 minâ€,â€œSpeed under the bar â€” land in quarter squatâ€),E(â€œGoblet Squatâ€,3,â€œ12â€,â€œ60sâ€,â€œMobility + activation â€” perfect depthâ€),E(â€œCable Face Pullâ€,3,â€œ15â€,â€œ60sâ€,â€œElbows high, external rotationâ€),E(â€œLateral Band Walkâ€,3,â€œ15/sideâ€,â€œ45sâ€,â€œKeep band tension throughoutâ€),E(â€œPallof Pressâ€,3,â€œ10/sideâ€,â€œ60sâ€,â€œAnti-rotation â€” do not twistâ€),E(â€œBox Jumpâ€,3,â€œ5â€,â€œ90sâ€,â€œFull reset between reps â€” quality over speedâ€)],1)}},
2:{name:â€œLoadingâ€,days:{
A:D(â€œFull Body â€” Primaryâ€,[E(â€œBack Squatâ€,4,â€œ5â€“7â€,â€œ2 minâ€,â€œAdd 2.5â€“5kg vs Month 1 top weightâ€),E(â€œRomanian Deadliftâ€,3,â€œ10â€,â€œ90sâ€,â€œIncrease load 5% â€” maintain formâ€),E(â€œPush Pressâ€,4,â€œ5â€“6â€,â€œ90sâ€,â€œHeavier; explosive dip-driveâ€),E(â€œPendlay Rowâ€,3,â€œ8â€,â€œ90sâ€,â€œBar starts on floor each rep â€” explosive pullâ€),E(â€œFarmerâ€™s Carryâ€,3,â€œ40mâ€,â€œ60sâ€,â€œHeavier than Month 1â€,1),E(â€œAb Wheel Rolloutâ€,3,â€œ10â€,â€œ60sâ€,â€œHips donâ€™t sag â€” slow and controlledâ€)]),
B:D(â€œFull Body â€” Primaryâ€,[E(â€œConventional Deadliftâ€,4,â€œ8â€,â€œ2 minâ€,â€œModerate weight â€” focus on form and hamstring stretchâ€),E(â€œBulgarian Split Squatâ€,3,â€œ8/sideâ€,â€œ90sâ€,â€œAdd weight â€” front foot elevated if mobileâ€),E(â€œBarbell Bench Pressâ€,3,â€œ8â€,â€œ90sâ€,â€œProgress from DBs â€” heavier compoundâ€),E(â€œCable Rowâ€,3,â€œ12â€,â€œ90sâ€,â€œPull elbows past torsoâ€,1),E(â€œArnold Pressâ€,3,â€œ10â€,â€œ90sâ€,â€œRotation adds shoulder muscleâ€),E(â€œSide Plank + Rowâ€,3,â€œ8/sideâ€,â€œ60sâ€,â€œCable or band â€” anti-lateral + pullingâ€)]),
C:D(â€œBonus â€” Olympic + Athleticâ€,[E(â€œPower Cleanâ€,4,â€œ4â€,â€œ2 minâ€,â€œAdd 2.5kg vs Month 1 â€” speed still keyâ€),E(â€œFront Squatâ€,3,â€œ6â€,â€œ90sâ€,â€œUpright torso, elbows highâ€),E(â€œDumbbell Lateral Raiseâ€,3,â€œ15â€,â€œ60sâ€,â€œSlow eccentric â€” 3 counts downâ€),E(â€œNordic Hamstring Curlâ€,3,â€œ6â€,â€œ90sâ€,â€œEccentric only; spotter or anchor feetâ€),E(â€œMed Ball Slamâ€,3,â€œ8â€,â€œ60sâ€,â€œMax force â€” full extension, fast slamâ€),E(â€œHanging Knee Raiseâ€,3,â€œ12â€,â€œ60sâ€,â€œPosterior tilt pelvis at topâ€)],1)}},
3:{name:â€œIntensityâ€,days:{
A:D(â€œFull Body â€” Primaryâ€,[E(â€œBack Squatâ€,5,â€œ5â€,â€œ2 minâ€,â€œ5x5 protocol â€” same weight across all setsâ€),E(â€œRomanian Deadliftâ€,4,â€œ8â€,â€œ90sâ€,â€œHeavier than Month 2â€),E(â€œPush Pressâ€,4,â€œ5â€,â€œ90sâ€,â€œNear max â€” explosive intent every repâ€),E(â€œBarbell Rowâ€,4,â€œ8â€,â€œ90sâ€,â€œOverhand grip â€” heavier loadâ€),E(â€œSuitcase Carryâ€,3,â€œ30m/sideâ€,â€œ60sâ€,â€œUnilateral â€” fights lateral leanâ€,1),E(â€œDragon Flag Progressionâ€,3,â€œ5â€“8â€,â€œ90sâ€,â€œTuck if needed â€” build to fullâ€)]),
B:D(â€œFull Body â€” Primaryâ€,[E(â€œDeadliftâ€,4,â€œ8â€,â€œ2 minâ€,â€œModerate load â€” control the eccentric, feel the posterior chainâ€),E(â€œWalking Lunge + Dumbbellsâ€,3,â€œ12/sideâ€,â€œ90sâ€,â€œAdds single-leg stability + loadâ€),E(â€œIncline Barbell Pressâ€,3,â€œ8â€,â€œ90sâ€,â€œUpper chest emphasisâ€),E(â€œSeated Cable Rowâ€,3,â€œ12â€,â€œ90sâ€,â€œClose grip â€” retract fullyâ€,1),E(â€œPush Press to Behind Neckâ€,3,â€œ8â€,â€œ90sâ€,â€œOnly if shoulder mobility allowsâ€),E(â€œCopenhagen Plankâ€,3,â€œ15s/sideâ€,â€œ60sâ€,â€œAdductor + core â€” sport carryoverâ€)]),
C:D(â€œBonus â€” Power + Coreâ€,[E(â€œHang Power Cleanâ€,4,â€œ4â€,â€œ2 minâ€,â€œKnee height start â€” teaches explosionâ€),E(â€œPaused Back Squatâ€,3,â€œ5â€,â€œ2 minâ€,â€œ2-sec pause at bottom â€” strength + mobilityâ€),E(â€œSingle Arm DB Pressâ€,3,â€œ10/sideâ€,â€œ90sâ€,â€œAnti-rotation challengeâ€),E(â€œGHD Hip Extensionâ€,3,â€œ12â€,â€œ60sâ€,â€œPosterior chain focusâ€),E(â€œBroad Jumpâ€,4,â€œ4â€,â€œ90sâ€,â€œMax distance â€” reset fully between repsâ€),E(â€œL-Sit Holdâ€,3,â€œ15â€“20sâ€,â€œ60sâ€,â€œParallel bars or floor â€” build hold timeâ€)],1)}},
4:{name:â€œPeak + Testâ€,days:{
A:D(â€œFull Body â€” Primaryâ€,[E(â€œBack Squat (Peak)â€,5,â€œ3â€,â€œ3 minâ€,â€œTest near-max â€” aim for 3RM PRâ€),E(â€œRomanian Deadliftâ€,4,â€œ6â€,â€œ90sâ€,â€œHeavy â€” same weight last 2 setsâ€),E(â€œPush Pressâ€,3,â€œ3â€,â€œ2 minâ€,â€œExplosive â€” test 3RMâ€),E(â€œBarbell Rowâ€,4,â€œ6â€,â€œ90sâ€,â€œHeavy â€” full ROM, no swingingâ€),E(â€œCarry Complexâ€,3,â€œVariedâ€,â€œ90sâ€,â€œFarmerâ€™s 20m + Rack 20m + Overhead 20mâ€,1),E(â€œWeighted Plankâ€,3,â€œ30sâ€,â€œ60sâ€,â€œPlate on back â€” maintain positionâ€)]),
B:D(â€œFull Body â€” Primaryâ€,[E(â€œDeadlift (Peak)â€,4,â€œ6â€,â€œ2.5 minâ€,â€œModerate-heavy â€” log your best set of 6â€),E(â€œBulgarian Split Squatâ€,3,â€œ6/sideâ€,â€œ90sâ€,â€œHeaviest load of the phaseâ€),E(â€œBarbell Bench Pressâ€,4,â€œ5â€,â€œ2 minâ€,â€œStrength test â€” aim for 5RMâ€),E(â€œWeighted Pull-Upâ€,3,â€œ6â€“8â€,â€œ90sâ€,â€œAdd load â€” belt or dumbbellâ€,1),E(â€œStrict Overhead Pressâ€,3,â€œ5â€,â€œ90sâ€,â€œTest strength â€” no leg driveâ€),E(â€œSingle-Leg RDLâ€,3,â€œ8/sideâ€,â€œ60sâ€,â€œBalance + hamstring â€” use KB or DBâ€)]),
C:D(â€œBonus â€” Athletic + Peakâ€,[E(â€œClean & Press Comboâ€,5,â€œ3â€,â€œ2.5 minâ€,â€œPower clean into push press â€” athletic flowâ€),E(â€œBox Squatâ€,3,â€œ5â€,â€œ2 minâ€,â€œControlled descent, explosive riseâ€),E(â€œPlyometric Push-Upâ€,3,â€œ8â€,â€œ90sâ€,â€œHands leave floor â€” power outputâ€),E(â€œBand Pull-Apartâ€,3,â€œ20â€,â€œ30sâ€,â€œShoulder health + rear deltâ€),E(â€œSprintâ€,4,â€œ20sâ€,â€œ90sâ€,â€œTrue max effort â€” long restâ€),E(â€œHollow Body Rockâ€,3,â€œ20â€,â€œ60sâ€,â€œCore tension through entire setâ€)],1)}},
5:{name:â€œStrength Baseâ€,days:{
A:D(â€œPrimary Strengthâ€,[E(â€œBack Squatâ€,5,â€œ5â€,â€œ3 minâ€,â€œLinear progression â€” add 2.5kg/weekâ€),E(â€œBench Pressâ€,5,â€œ5â€,â€œ2.5 minâ€,â€œGrip slightly wider than shoulder widthâ€),E(â€œBarbell Rowâ€,5,â€œ5â€,â€œ2.5 minâ€,â€œMirror squat day â€” equal pulling volumeâ€),E(â€œGlute Ham Raiseâ€,3,â€œ8â€,â€œ90sâ€,â€œTrue knee flexion â€” not hip extensionâ€),E(â€œWeighted Dipâ€,3,â€œ8â€,â€œ90sâ€,â€œLean forward for chest focusâ€)]),
B:D(â€œDeadlift + Olympicâ€,[E(â€œDeadliftâ€,4,â€œ8â€,â€œ2.5 minâ€,â€œModerate weight â€” volume over intensityâ€),E(â€œOverhead Pressâ€,5,â€œ5â€,â€œ2.5 minâ€,â€œStrict form â€” no lay-backâ€),E(â€œPower Cleanâ€,4,â€œ4â€,â€œ2.5 minâ€,â€œBefore fatigue sets in â€” speed lifts firstâ€),E(â€œChin-Up (weighted)â€,4,â€œ6â€,â€œ2 minâ€,â€œSlow eccentric â€” 3 count downâ€),E(â€œAb Rolloutâ€,3,â€œ12â€,â€œ60sâ€,â€œFull extension if shoulder stableâ€)]),
C:D(â€œBonus â€” Power + Conditioningâ€,[E(â€œSnatch-Grip High Pullâ€,4,â€œ4â€,â€œ2 minâ€,â€œWide grip â€” hip power to bar heightâ€),E(â€œPaused Squatâ€,3,â€œ5â€,â€œ2.5 minâ€,â€œ3-sec pause â€” build bottom strengthâ€),E(â€œClose-Grip Benchâ€,3,â€œ8â€,â€œ90sâ€,â€œTricep emphasis â€” elbows tuckedâ€),E(â€œFace Pullâ€,3,â€œ15â€,â€œ60sâ€,â€œShoulder health â€” do not skipâ€),E(â€œSled Pushâ€,4,â€œ20mâ€,â€œ90sâ€,â€œHeavy and low â€” hip extension emphasisâ€)],1)}},
6:{name:â€œStrength Loadingâ€,days:{
A:D(â€œPrimaryâ€,[E(â€œBack Squatâ€,5,â€œ4â€,â€œ3 minâ€,â€œIncrease weight â€” lower volume per setâ€),E(â€œBench Pressâ€,5,â€œ4â€,â€œ2.5 minâ€,â€œAdd 5kg vs Month 5 working weightâ€),E(â€œPendlay Rowâ€,5,â€œ4â€,â€œ2.5 minâ€,â€œReset on floor â€” explosive concentricâ€),E(â€œRomanian Deadliftâ€,3,â€œ8â€,â€œ90sâ€,â€œAccessory â€” hamstring hypertrophyâ€),E(â€œCable Fly + Push-Upâ€,3,â€œ12+8â€,â€œ90sâ€,â€œMetabolic finisher â€” chest pumpâ€,1)]),
B:D(â€œDeadlift + Olympicâ€,[E(â€œDeadliftâ€,4,â€œ8â€,â€œ2.5 minâ€,â€œModerate load â€” controlled reps, no grindingâ€),E(â€œOverhead Pressâ€,5,â€œ4â€,â€œ2.5 minâ€,â€œAdd 2.5kg â€” strictâ€),E(â€œHang Power Snatchâ€,4,â€œ3â€,â€œ2.5 minâ€,â€œNew skill â€” lighter load, perfect formâ€),E(â€œWeighted Pull-Upâ€,4,â€œ5â€,â€œ2 minâ€,â€œIncrease weight from Phase 1â€),E(â€œLandmine Rotationâ€,3,â€œ10/sideâ€,â€œ60sâ€,â€œRotational power â€” sport patternâ€)]),
C:D(â€œBonus â€” Complex Liftsâ€,[E(â€œClean Pullâ€,4,â€œ4â€,â€œ2 minâ€,â€œLoad heavier than clean â€” pull onlyâ€),E(â€œFront Squatâ€,4,â€œ4â€,â€œ2.5 minâ€,â€œUpright torso â€” builds clean rack positionâ€),E(â€œFloor Pressâ€,3,â€œ6â€,â€œ2 minâ€,â€œNo leg drive â€” pure press strengthâ€),E(â€œSingle-Arm Row (heavy)â€,3,â€œ8/sideâ€,â€œ90sâ€,â€œBrace on bench â€” max weightâ€),E(â€œProwler Sprintâ€,4,â€œ15mâ€,â€œ2 minâ€,â€œLight + fast â€” power, not strengthâ€)],1)}},
7:{name:â€œIntensity Peakâ€,days:{
A:D(â€œStrength Peakâ€,[E(â€œBack Squatâ€,6,â€œ3â€,â€œ3 minâ€,â€œVolume + intensity â€” 6 sets of 3â€),E(â€œBench Pressâ€,4,â€œ4â€,â€œ3 minâ€,â€œWork up to heavy top set of 4â€),E(â€œBarbell Rowâ€,4,â€œ5â€,â€œ2.5 minâ€,â€œHeavier than Month 6â€),E(â€œLeg Press (tempo)â€,3,â€œ10â€,â€œ90sâ€,â€œ3 sec down, 1 up â€” volume for quadsâ€),E(â€œSkull Crusherâ€,3,â€œ12â€,â€œ60sâ€,â€œLong head tricep â€” overhead positionâ€)]),
B:D(â€œPower Peakâ€,[E(â€œDeadliftâ€,4,â€œ6â€,â€œ2.5 minâ€,â€œModerate-heavy â€” quality reps over max weightâ€),E(â€œOverhead Pressâ€,4,â€œ4â€,â€œ2.5 minâ€,â€œWork to heavy set of 4â€),E(â€œPower Clean + Front Squatâ€,4,â€œ2+2â€,â€œ3 minâ€,â€œCombo â€” power + strength flowâ€),E(â€œWeighted Pull-Upâ€,4,â€œ5â€,â€œ2 minâ€,â€œAdd load from Month 6â€),E(â€œGHD Sit-Upâ€,3,â€œ12â€,â€œ60sâ€,â€œHip flexor + core â€” eccentric controlâ€)]),
C:D(â€œBonus â€” Jerk + Explosiveâ€,[E(â€œJerk (split or push)â€,4,â€œ3â€,â€œ3 minâ€,â€œOverhead lockout â€” shoulder stabilityâ€),E(â€œSafety Bar Squatâ€,3,â€œ6â€,â€œ2.5 minâ€,â€œDifferent stimulus â€” upper back demandâ€),E(â€œIncline DB Pressâ€,3,â€œ10â€,â€œ90sâ€,â€œAccessory upper chestâ€),E(â€œT-Bar Rowâ€,3,â€œ8â€,â€œ90sâ€,â€œChest supported or bent overâ€),E(â€œBox Jump to Depth Jumpâ€,4,â€œ4â€,â€œ2 minâ€,â€œLand, immediately rebound â€” reactiveâ€)],1)}},
8:{name:â€œPhase 2 Peak Testâ€,days:{
A:D(â€œStrength Testingâ€,[E(â€œBack Squat (Peak Test)â€,1,â€œ1â€“3â€,â€œ5 minâ€,â€œWork to heavy single or triple â€” log itâ€),E(â€œBench Press (Peak Test)â€,1,â€œ1â€“3â€,â€œ5 minâ€,â€œTest 1RM or 3RM â€” record resultâ€),E(â€œBarbell Rowâ€,3,â€œ5â€,â€œ2.5 minâ€,â€œDeload volume â€” maintain strengthâ€),E(â€œDumbbell Accessoriesâ€,2,â€œ12â€,â€œ60sâ€,â€œLight â€” pump, not performanceâ€),E(â€œCore Circuitâ€,2,â€œVariedâ€,â€œ60sâ€,â€œ3 movements, 45s each â€” just moveâ€)]),
B:D(â€œFull Power Testâ€,[E(â€œDeadlift (Peak Test)â€,1,â€œ5â€“8â€,â€œ4 minâ€,â€œTest your best set of 5â€“8 â€” log itâ€),E(â€œOverhead Press (Peak Test)â€,1,â€œ3â€,â€œ4 minâ€,â€œTest 3RM strict â€” benchmarkâ€),E(â€œPower Clean (Max Weight)â€,3,â€œ2â€,â€œ3 minâ€,â€œHeaviest clean attempt â€” form firstâ€),E(â€œPull-Up (max reps)â€,1,â€œMaxâ€,â€â€”â€,â€œBodyweight â€” record for future referenceâ€),E(â€œLoaded Carry Medleyâ€,2,â€œVariedâ€,â€œ2 minâ€,â€œAll carry variations â€” celebration setâ€)]),
C:D(â€œBonus â€” Peak Testâ€,[E(â€œPower Clean (Max)â€,3,â€œ2â€,â€œ3 minâ€,â€œHeaviest attempt â€” speed + formâ€),E(â€œBox Squatâ€,3,â€œ5â€,â€œ2 minâ€,â€œExplosive riseâ€),E(â€œWeighted Pull-Upâ€,3,â€œ6â€,â€œ2 minâ€,â€œMax loadâ€),E(â€œSled Pushâ€,4,â€œ20mâ€,â€œ90sâ€,â€œHeavy â€” finish strongâ€),E(â€œCore Circuitâ€,2,â€œVariedâ€,â€œ60sâ€,â€œ3 movements â€” celebrateâ€)],1)}},
9:{name:â€œTransitionâ€,days:{
A:D(â€œStrength + Volumeâ€,[E(â€œBack Squatâ€,4,â€œ6â€“8â€,â€œ90sâ€,â€œModerate weight â€” increased volume, less restâ€),E(â€œBench Pressâ€,4,â€œ8â€,â€œ90sâ€,â€œHypertrophy rep range again â€” pump workâ€),E(â€œCable Rowâ€,4,â€œ12â€,â€œ60sâ€,â€œConstant tension â€” full contractionâ€),E(â€œLeg Extension + Leg Curlâ€,3,â€œ15+15â€,â€œ60sâ€,â€œIsolation for definition phaseâ€,1),E(â€œDips (bodyweight)â€,3,â€œMaxâ€,â€œ60sâ€,â€œMax reps â€” push enduranceâ€),E(â€œMetabolic Finisherâ€,1,â€œ8 minâ€,â€â€”â€,â€œEMOM: 5 KB swings + 5 push-ups each minuteâ€)]),
B:D(â€œAthletic Powerâ€,[E(â€œPower Cleanâ€,4,â€œ4â€,â€œ2 minâ€,â€œMaintain Olympic lifting â€” athletic baseâ€),E(â€œFront Squatâ€,3,â€œ8â€,â€œ90sâ€,â€œHigh volume front squats â€” quad focusâ€),E(â€œPush Pressâ€,4,â€œ8â€,â€œ90sâ€,â€œModerate weight â€” explosiveness maintainedâ€),E(â€œPull-Up Clusterâ€,4,â€œ6â€“8â€,â€œ90sâ€,â€œSupinate grip variety â€” bicep + backâ€),E(â€œLandmine Press (split stance)â€,3,â€œ10/sideâ€,â€œ60sâ€,â€œSport-pattern pressingâ€),E(â€œSled/Prowler (conditioning)â€,4,â€œ30mâ€,â€œ90sâ€,â€œModerate load â€” aerobic capacityâ€)]),
C:D(â€œBonus â€” Conditioning Focusâ€,[E(â€œKettlebell Complexâ€,4,â€œ5 roundsâ€,â€œ2 minâ€,â€œSwing + Clean + Press + Squat â€” unbrokenâ€),E(â€œSingle-Leg RDLâ€,3,â€œ10/sideâ€,â€œ60sâ€,â€œBalance + posterior chainâ€),E(â€œArnold Pressâ€,3,â€œ12â€,â€œ60sâ€,â€œShoulder detail â€” full rotationâ€),E(â€œFace Pullâ€,3,â€œ20â€,â€œ45sâ€,â€œRear delt + rotator cuff healthâ€),E(â€œBattle Rope or Jump Ropeâ€,4,â€œ30sâ€,â€œ30sâ€,â€œConditioning â€” work:rest 1:1â€),E(â€œHollow Rockâ€,3,â€œ30sâ€,â€œ45sâ€,â€œCore enduranceâ€)],1)}},
10:{name:â€œDefinition Pushâ€,days:{
A:D(â€œVolume + Definitionâ€,[E(â€œBack Squatâ€,4,â€œ8â€“10â€,â€œ90sâ€,â€œVolume up â€” definition phase loadingâ€),E(â€œIncline Bench Pressâ€,4,â€œ10â€,â€œ90sâ€,â€œUpper chest focus for shapeâ€),E(â€œBarbell Rowâ€,4,â€œ10â€,â€œ90sâ€,â€œControlled â€” squeeze at topâ€),E(â€œWalking Lunge (weighted)â€,3,â€œ12/sideâ€,â€œ60sâ€,â€œGlute + quad definitionâ€),E(â€œCable Flyâ€,3,â€œ15â€,â€œ45sâ€,â€œStretch at bottom â€” no touching at topâ€),E(â€œMetabolic Finisherâ€,1,â€œ10 minâ€,â€â€”â€,â€œAMRAP: 8 box jumps + 8 DB thrusters + 200m rowâ€)]),
B:D(â€œPower + Conditioningâ€,[E(â€œHang Power Snatchâ€,4,â€œ4â€,â€œ2 minâ€,â€œSpeed and precision â€” not max loadâ€),E(â€œBox Squatâ€,3,â€œ6â€,â€œ2 minâ€,â€œExplosive â€” drive up fastâ€),E(â€œStrict Pressâ€,4,â€œ8â€,â€œ90sâ€,â€œKeep pressing strength with volumeâ€),E(â€œWeighted Chin-Upâ€,4,â€œ8â€,â€œ90sâ€,â€œHeavy â€” back thickness workâ€),E(â€œTyre Flip or Sled Dragâ€,4,â€œ20mâ€,â€œ90sâ€,â€œRaw power + conditioning blendâ€),E(â€œCopenhagen Plankâ€,3,â€œ20s/sideâ€,â€œ45sâ€,â€œAdductor strength â€” hockey carry-overâ€)]),
C:D(â€œBonus â€” Sport + Athleticâ€,[E(â€œSport Circuitâ€,5,â€œ3 roundsâ€,â€œ90sâ€,â€œBox jump + Sprint + Med Ball Slam â€” explosiveâ€),E(â€œPaused Goblet Squatâ€,3,â€œ12â€,â€œ60sâ€,â€œMobility maintenance â€” deep squatâ€),E(â€œLateral Raise (cable)â€,3,â€œ15â€,â€œ45sâ€,â€œSide delt detailâ€),E(â€œHamstring Curlâ€,3,â€œ12â€,â€œ60sâ€,â€œInjury prevention â€” eccentric controlâ€),E(â€œFarmerâ€™s Carry + Sprint finishâ€,3,â€œ30m+15mâ€,â€œ90sâ€,â€œDrop weights and sprint â€” contrastâ€),E(â€œPlank Variations Circuitâ€,2,â€œ3 minâ€,â€œ60sâ€,â€œ4 plank positions â€” 45s eachâ€)],1)}},
11:{name:â€œFinal Buildâ€,days:{
A:D(â€œHeavy + Volumeâ€,[E(â€œBack Squatâ€,5,â€œ5â€,â€œ2.5 minâ€,â€œReturn to strength rep range â€” carry bothâ€),E(â€œBench Pressâ€,5,â€œ5â€,â€œ2.5 minâ€,â€œHeavy again â€” maintain Phase 2 gainsâ€),E(â€œBarbell Rowâ€,5,â€œ5â€,â€œ2.5 minâ€,â€œMatch squat â€” balanced push/pullâ€),E(â€œLeg Pressâ€,3,â€œ15â€,â€œ60sâ€,â€œVolume add â€” legs are priorityâ€),E(â€œSkullcrusher + Curlâ€,3,â€œ12+12â€,â€œ60sâ€,â€œArm detail + symmetryâ€,1),E(â€œWeighted Vest Walk / Hikeâ€,1,â€œ20 minâ€,â€â€”â€,â€œLow intensity â€” recovery + conditioningâ€)]),
B:D(â€œFull Athletic Expressionâ€,[E(â€œClean & Jerk (complex)â€,5,â€œ2+2â€,â€œ3 minâ€,â€œShow off your year of work â€” max weightâ€),E(â€œFront Squatâ€,3,â€œ5â€,â€œ2.5 minâ€,â€œStrength â€” close to Phase 2 loadsâ€),E(â€œPush Pressâ€,3,â€œ5â€,â€œ2 minâ€,â€œHeavy â€” athletic overhead powerâ€),E(â€œPull-Up (weighted)â€,4,â€œ6â€,â€œ2 minâ€,â€œStrongest youâ€™ve ever been â€” test itâ€),E(â€œAthletic Circuitâ€,3,â€œ4 minâ€,â€œ2 minâ€,â€œSprint + Jump + Carry â€” sport feelâ€)]),
C:D(â€œBonus â€” Plyometric + Carryâ€,[E(â€œPlyometric Complexâ€,4,â€œ4â€,â€œ2 minâ€,â€œDepth jump + Broad jump + Sprint â€” max CNSâ€),E(â€œLoaded Carry Medleyâ€,3,â€œVariedâ€,â€œ2 minâ€,â€œAll carries â€” test your grip + coreâ€),E(â€œBand Work (shoulder care)â€,2,â€œ20/sideâ€,â€œ30sâ€,â€œRotator cuff â€” maintain healthâ€),E(â€œCore Circuit (max effort)â€,3,â€œ5 minâ€,â€œ2 minâ€,â€œDragon flag + L-sit + Hollow rockâ€),E(â€œGrip Trainingâ€,2,â€œ30sâ€,â€œ60sâ€,â€œDead hang or towel pull-upâ€)],1)}},
12:{name:â€œYear-End Peakâ€,days:{
A:D(â€œFull Year PR Testâ€,[E(â€œBack Squat (Year PR)â€,1,â€œ1â€“5â€,â€œ5 minâ€,â€œTest your actual year progress â€” 1, 3, or 5RMâ€),E(â€œBench Press (Year PR)â€,1,â€œ1â€“5â€,â€œ5 minâ€,â€œSame â€” log and compare to Month 1â€),E(â€œDeadlift (Year PR)â€,1,â€œ5â€“8â€,â€œ4 minâ€,â€œBest set of 5â€“8 â€” celebrate this momentâ€),E(â€œBarbell Row (Year PR)â€,3,â€œ5â€,â€œ3 minâ€,â€œHeaviest row of your life â€” earn itâ€),E(â€œOverhead Press (Year PR)â€,3,â€œ5â€,â€œ3 minâ€,â€œFinish with your strict press bestâ€)]),
B:D(â€œCelebration + Reflectionâ€,[E(â€œClean & Press (Year Max)â€,4,â€œ2â€,â€œ3 minâ€,â€œMax load â€” clean into push pressâ€),E(â€œSquat Variation of Choiceâ€,3,â€œ8â€,â€œ90sâ€,â€œYour favourite â€” reward yourselfâ€),E(â€œPull-Up (bodyweight max)â€,2,â€œMaxâ€,â€œ3 minâ€,â€œCompare to Month 8 resultâ€),E(â€œLoaded Carry (celebration)â€,3,â€œFreeâ€,â€œ90sâ€,â€œJust carry heavy things â€” enjoy itâ€),E(â€œCore + Mobility Flowâ€,1,â€œ15 minâ€,â€â€”â€,â€œWind down â€” honour the yearâ€)]),
C:D(â€œBonus â€” Sport + Recoveryâ€,[E(â€œSport Day â€” Free Choiceâ€,0,â€â€”â€,â€â€”â€,â€œPlay a sport, skate, run, be athleticâ€),E(â€œReflect + Deloadâ€,0,â€â€”â€,â€â€”â€,â€œLight movement only â€” celebrate recoveryâ€),E(â€œWritten Benchmark Reviewâ€,0,â€â€”â€,â€â€”â€,â€œLog all PRs vs start â€” month by monthâ€)],1)}}
}};

const BENCHMARKS=[{key:â€œsquatâ€,name:â€œBack Squat (3RM)â€},{key:â€œdeadliftâ€,name:â€œDeadlift (3RM)â€},{key:â€œbenchâ€,name:â€œBench Press (3RM)â€},{key:â€œohpâ€,name:â€œOverhead Press (3RM)â€},{key:â€œcleanâ€,name:â€œPower Clean (max)â€},{key:â€œpullupsâ€,name:â€œPull-Ups (max reps)â€},{key:â€œbwâ€,name:â€œBodyweight (lbs)â€}];
const PHASES=[{num:1,months:[1,2,3,4],name:â€œHYPERTROPHYâ€,color:â€œphase-1â€},{num:2,months:[5,6,7,8],name:â€œSTRENGTH + POWERâ€,color:â€œphase-2â€},{num:3,months:[9,10,11,12],name:â€œRECOMPOSITION + PEAKâ€,color:â€œphase-3â€}];
let state={startDate:null,log:{},benchmarks:{},completedDays:{}};

// â€“â€“ Timer â€“â€“
let timerInterval=null,timerSeconds=0,timerRunning=false;
function formatTime(s){
const h=Math.floor(s/3600),m=Math.floor((s%3600)/60),sec=s%60;
if(h>0)return `${h}:${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
return `${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
}
function updateTimerDisplay(){document.getElementById(â€˜timer-displayâ€™).textContent=formatTime(timerSeconds);}
function toggleTimer(){
const btn=document.getElementById(â€˜timer-toggle-btnâ€™);
if(timerRunning){clearInterval(timerInterval);timerInterval=null;timerRunning=false;btn.textContent=â€˜RESUMEâ€™;btn.className=â€˜timer-btn pausedâ€™;}
else{timerRunning=true;timerInterval=setInterval(()=>{timerSeconds++;updateTimerDisplay();},1000);btn.textContent=â€˜PAUSEâ€™;btn.className=â€˜timer-btn runningâ€™;}
}
function resetTimer(){clearInterval(timerInterval);timerInterval=null;timerRunning=false;timerSeconds=0;updateTimerDisplay();const btn=document.getElementById(â€˜timer-toggle-btnâ€™);btn.textContent=â€˜STARTâ€™;btn.className=â€˜timer-btnâ€™;}
function stopTimer(){clearInterval(timerInterval);timerInterval=null;timerRunning=false;}

// â€“â€“ State persistence â€“â€“
async function saveState(){
try{localStorage.setItem(â€˜stefan_workout_v1â€™,JSON.stringify(state));}catch(e){}
try{await window.storage.set(â€˜workout_v1â€™,JSON.stringify(state));}catch(e){}
}
async function loadState(){
try{const s=localStorage.getItem(â€˜stefan_workout_v1â€™);if(s){state=JSON.parse(s);return;}}catch(e){}
try{const r=await window.storage.get(â€˜workout_v1â€™);if(r&&r.value){state=JSON.parse(r.value);return;}}catch(e){}
}

function getCurrentPosition(){
if(!state.startDate)return null;
const start=new Date(state.startDate),today=new Date();
const diffDays=Math.floor((today-start)/(864e5));
const week=Math.floor(diffDays/7)+1;
const month=Math.min(Math.ceil(week/4),12);
const weekInMonth=((week-1)%4)+1;
return{week,month,weekInMonth,isDeload:weekInMonth===4,phase:PHASES.find(p=>p.months.includes(month))};
}

function setupPlan(){
let val=document.getElementById(â€˜start-date-inputâ€™).value;
if(!val){
val=new Date().toISOString().split(â€˜Tâ€™)[0];
document.getElementById(â€˜start-date-inputâ€™).value=val;
}
state.startDate=val;saveState();
initHomeScreen();goTo(â€˜home-screenâ€™);
document.getElementById(â€˜bottom-navâ€™).classList.add(â€˜visibleâ€™);
}

function goTo(screenId){
document.querySelectorAll(â€™.screenâ€™).forEach(s=>s.classList.remove(â€˜activeâ€™));
document.getElementById(screenId).classList.add(â€˜activeâ€™);
if(screenId===â€˜home-screenâ€™)initHomeScreen();
if(screenId===â€˜plan-screenâ€™)initPlanScreen();
if(screenId===â€˜weight-screenâ€™)initWeightScreen();
if(screenId===â€˜benchmark-screenâ€™)initBenchmarkScreen();
if(screenId===â€˜history-screenâ€™)initHistoryScreen();
if(screenId===â€˜settings-screenâ€™)initSettingsScreen();
}

function navTo(screenId,navId){
document.querySelectorAll(â€™.nav-itemâ€™).forEach(n=>n.classList.remove(â€˜activeâ€™));
document.getElementById(navId).classList.add(â€˜activeâ€™);
goTo(screenId);
}

function initHomeScreen(){
const pos=getCurrentPosition();if(!pos)return;
const{month,weekInMonth,isDeload,phase,week}=pos;
const md=PLAN.months[month];
const pl=document.getElementById(â€˜home-phase-labelâ€™);
pl.textContent=`PHASE ${phase.num} â€” ${phase.name}`;pl.className=`home-phase-label ${phase.color}`;
document.getElementById(â€˜home-titleâ€™).textContent=`MONTH ${month} â€” ${md.name.toUpperCase()}`;
document.getElementById(â€˜home-metaâ€™).textContent=`Week ${weekInMonth} of 4  Â·  Overall Week ${week}`;
const strip=document.getElementById(â€˜home-week-stripâ€™);strip.innerHTML=â€™â€™;
for(let i=1;i<=4;i++){const p=document.createElement(â€˜divâ€™);p.className=â€˜week-pipâ€™+(i<weekInMonth?â€™ doneâ€™:i===weekInMonth?â€™ currentâ€™:â€™â€™);strip.appendChild(p);}
document.getElementById(â€˜deload-bannerâ€™).style.display=isDeload?â€˜flexâ€™:â€˜noneâ€™;
const cards=document.getElementById(â€˜day-cardsâ€™);cards.innerHTML=â€™â€™;
[â€˜Aâ€™,â€˜Bâ€™,â€˜Câ€™].forEach(day=>{
const dd=md.days[day];const isBonus=dd.bonus;
const sk=`${month}_${weekInMonth}_${day}`;const completionInfo=state.completedDays[sk];
const isDone=!!completionInfo;
const card=document.createElement(â€˜divâ€™);
card.className=`day-card${isBonus?' bonus':''}${isDone?' completed':''}`;
let dateLabel=â€™â€™;
if(isDone && completionInfo.date){
const d=new Date(completionInfo.date+â€˜T12:00:00â€™);
dateLabel=` Â· ${d.toLocaleDateString('en-US',{month:'short',day:'numeric'})}`;
}
card.innerHTML=`<div><div class="day-card-tag">Day ${day}${isBonus?' Â· Optional':' Â· Required'}${dateLabel}</div><div class="day-card-name">${dd.name}</div><div class="day-card-count">${dd.exercises.length} exercises</div></div><div style="display:flex;align-items:center;gap:8px">${isDone?`<button class="day-card-undo" onclick="event.stopPropagation();undoDay('${sk}')">UNDO</button>`:''}<div class="day-card-arrow">â†’</div></div>`;
card.onclick=()=>isDone?startWorkout(month,weekInMonth,day,true):startWorkout(month,weekInMonth,day);
card.style.opacity=isDone?â€˜0.75â€™:â€˜1â€™;
cards.appendChild(card);
});
const mini=document.getElementById(â€˜benchmark-miniâ€™);mini.innerHTML=â€™â€™;
[â€˜squatâ€™,â€˜deadliftâ€™,â€˜benchâ€™,â€˜ohpâ€™].forEach(key=>{
const lift=BENCHMARKS.find(b=>b.key===key);const vals=state.benchmarks[key]||{};
const v=vals.m12||vals.m8||vals.m4||vals.m1||â€™â€”â€™;
mini.innerHTML+=`<div><div class="benchmark-mini-label">${lift.name.replace(' (3RM)','')}</div><div class="benchmark-mini-val ${v!=='â€”'?'filled':''}">${v!=='â€”'?v+' lbs':'â€”'}</div></div>`;
});
// Row PR indicator
const existingRowCard=document.getElementById(â€˜home-row-cardâ€™);
if(existingRowCard)existingRowCard.remove();
const rowTimes=(state.rowTimes||[]).map(t=>t.seconds).filter(s=>s>0);
if(rowTimes.length){
const best=Math.min(â€¦rowTimes);
const last=[â€¦(state.rowTimes||[])].sort((a,b)=>b.date.localeCompare(a.date))[0];
const rowCard=document.createElement(â€˜divâ€™);
rowCard.id=â€˜home-row-cardâ€™;
rowCard.style.cssText=â€˜background:var(â€“surface);border:1px solid #00d4ff33;border-radius:10px;padding:12px 16px;margin-top:10px;display:flex;justify-content:space-between;align-items:center;cursor:pointerâ€™;
rowCard.innerHTML=`<div><div style="font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:3px;color:var(--phase3);text-transform:uppercase">ğŸš£ 1KM ROW</div><div style="font-size:11px;color:var(--text-muted);margin-top:2px">${rowTimes.length} session${rowTimes.length!==1?'s':''} Â· Last: ${formatRowTime(last.seconds)}</div></div><div style="font-family:var(--bc);font-size:22px;font-weight:900;color:var(--phase3)">${formatRowTime(best)}</div>`;
rowCard.onclick=()=>showRowHistory();
document.querySelector(â€™.benchmark-cardâ€™).parentElement.appendChild(rowCard);
}
}

let currentWorkout={month:null,week:null,day:null,logKey:null,isReview:false,isEditing:false,savedLogKey:null};

function confirmExitWorkout(){
if(currentWorkout.isReview && !currentWorkout.isEditing){
stopTimer();resetTimer();resetRowTimer();goTo(â€˜home-screenâ€™);return;
}
showConfirm(â€˜Exit Workout?â€™,â€˜You have an active workout in progress. Your unsaved data for this session will be lost.â€™,â€˜Exitâ€™,()=>{stopTimer();resetTimer();resetRowTimer();goTo(â€˜home-screenâ€™);});
}

function startWorkout(month,week,day,reviewMode){
const dayData=PLAN.months[month].days[day];
const logKey=`${month}_${week}_${day}`;
const completionInfo=state.completedDays[logKey];
const isReview=!!reviewMode;
// Find saved log data for this session
let savedData=null,savedLogKey=null;
if(completionInfo && completionInfo.savedLogKey && state.log[completionInfo.savedLogKey]){
savedLogKey=completionInfo.savedLogKey;
savedData=state.log[savedLogKey];
}
currentWorkout={month,week,day,logKey,isReview,isEditing:false,savedLogKey};
const phase=PHASES.find(p=>p.months.includes(month));
const tag=document.getElementById(â€˜workout-day-tagâ€™);
tag.textContent=`PHASE ${phase.num} Â· MONTH ${month} Â· DAY ${day}`;tag.className=`workout-day-tag ${phase.color}`;
document.getElementById(â€˜workout-titleâ€™).textContent=dayData.name.toUpperCase();
resetTimer();
const content=document.getElementById(â€˜workout-contentâ€™);content.innerHTML=â€™â€™;
// Date display for completed workouts
if(isReview && completionInfo){
const dateStr=completionInfo.date||â€˜Unknownâ€™;
const d=new Date(dateStr+â€˜T12:00:00â€™);
const nice=d.toLocaleDateString(â€˜en-USâ€™,{weekday:â€˜longâ€™,month:â€˜longâ€™,day:â€˜numericâ€™,year:â€˜numericâ€™});
content.innerHTML+=`<div id="workout-date-bar" style="padding:12px 0;margin-bottom:4px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border)"><div><div style="font-size:9px;letter-spacing:2px;color:var(--text-muted);text-transform:uppercase;margin-bottom:3px">Completed</div><div id="workout-date-display" style="font-family:var(--bc);font-size:16px;font-weight:700;color:var(--green)">${nice}</div></div><input type="date" id="workout-date-edit" value="${dateStr}" style="display:none;background:var(--surface2);border:1px solid var(--border);border-radius:6px;padding:8px 10px;color:var(--text);font-family:var(--bc);font-size:14px" onchange="updateWorkoutDate(this.value)"></div>`;
}
const lastSessionData=isReview?{}:getLastSessionWeights(day);
const rpeOpts=[6,7,8,9,10].map(v=>`<option value="${v}">${v}</option>`).join(â€™â€™);
dayData.exercises.forEach((ex,exIdx)=>{
const exDiv=document.createElement(â€˜divâ€™);exDiv.className=â€˜exercise-itemâ€™;exDiv.id=`ex-${exIdx}`;
const lastW=lastSessionData[ex.name];
let lastHint=â€™â€™;
if(lastW){
const rpeLabel=lastW.avgRPE?` Â· RPE ${lastW.avgRPE.toFixed(1)}`:â€™â€™;
let suggestHTML=â€™â€™;
if(lastW.suggested!=null){
const diff=lastW.suggested-lastW.last;
const arrow=diff>0?â€˜â†‘â€™:diff<0?â€˜â†“â€™:â€˜â†’â€™;
const color=diff>0?â€˜var(â€“green)â€™:diff<0?â€˜var(â€“red)â€™:â€˜var(â€“accent-dim)â€™;
suggestHTML=`<span style="color:${color};margin-left:10px">${arrow} Aim for <strong>${lastW.suggested} lbs</strong>${diff!==0?` (${diff>0?â€™+â€™:â€™â€™}${diff})`:''}</span>`;
}
lastHint=`<div class="last-weight-hint">Last: <span>${lastW.last} lbs${rpeLabel}</span>${suggestHTML}</div>`;
}
// Get saved values for this exercise
const savedEx=savedData?savedData[ex.name]:null;
let setsHTML=â€™â€™;const numSets=ex.sets||1;
for(let s=0;s<numSets;s++){
const sv=savedEx&&savedEx[s]?savedEx[s]:{};
const wVal=sv.weight||â€™â€™;
const rVal=sv.rpe||â€™â€™;
const isDone=sv.done||false;
const readOnly=isReview?â€™ disabledâ€™:â€™â€™;
const rpeSelected=(val)=>rVal==val?â€˜selectedâ€™:â€™â€™;
setsHTML+=`<div class="log-set-row"><div class="set-num">S${s+1}</div><div class="log-input-wrap"><div class="log-input-label">WEIGHT (lbs)</div><input type="number" class="log-input${wVal?' filled':''}" id="w-${exIdx}-${s}" value="${wVal}" placeholder="â€”" oninput="onInputChange(${exIdx},${s})" onfocus="this.select()"${readOnly}></div><div class="rpe-wrap"><div class="log-input-label">RPE</div><select class="rpe-select${rVal?' filled':''}" id="r-${exIdx}-${s}" onchange="onInputChange(${exIdx},${s})"${readOnly}><option value="">â€”</option><option value="6" ${rpeSelected(6)}>6</option><option value="7" ${rpeSelected(7)}>7</option><option value="8" ${rpeSelected(8)}>8</option><option value="9" ${rpeSelected(9)}>9</option><option value="10" ${rpeSelected(10)}>10</option></select></div><button class="set-check${isDone?' done':''}" id="chk-${exIdx}-${s}" onclick="toggleSetDone(${exIdx},${s})"${isReview?' disabled':''}>${isDone?'âœ“':'â—‹'}</button></div>`;
}
exDiv.innerHTML=`<div class="exercise-header"><div class="exercise-name" onclick="showExHistory('${ex.name.replace(/'/g,"\\'")}')">${ex.name}</div>${ex.superset?'<div class="exercise-superset-tag">SUPERSET</div>':''}</div><div class="exercise-specs"><div><div class="spec-label">Sets</div><div class="spec-val">${ex.sets||'â€”'}</div></div><div><div class="spec-label">Reps</div><div class="spec-val">${ex.reps}</div></div><div><div class="spec-label">Rest</div><div class="spec-val">${ex.rest}</div></div></div><div class="exercise-note${ex.superset?' superset-note':''}">${ex.note}</div>${lastHint}<div class="log-sets">${setsHTML}</div>`;
content.appendChild(exDiv);
});
addedExercises=[];
updateProgress();
// Add movement button (not shown in review mode)
if(!isReview){
const addBtn=document.createElement(â€˜divâ€™);
addBtn.id=â€˜add-movement-btnâ€™;addBtn.className=â€˜btn-add-workoutâ€™;
addBtn.innerHTML=â€™<div class="btn-add-workout-text">+ ADD MOVEMENT</div>â€™;
addBtn.onclick=()=>openAddMovement();
content.appendChild(addBtn);
}
// Row tracker at the bottom
resetRowTimer();
const rowDiv=document.createElement(â€˜divâ€™);
rowDiv.id=â€˜row-tracker-wrapâ€™;
rowDiv.innerHTML=buildRowTrackerHTML();
content.appendChild(rowDiv);
if(isReview && completionInfo && completionInfo.rowTime){
rowTimerSeconds=completionInfo.rowTime;
updateRowDisplay();
const savedEl=document.getElementById(â€˜row-saved-msgâ€™);
if(savedEl){savedEl.style.display=â€˜blockâ€™;savedEl.textContent=`RECORDED â€” ${formatRowTime(completionInfo.rowTime)}`;}
const startBtn=document.getElementById(â€˜row-start-btnâ€™);
const resetBtn=startBtn?.nextElementSibling;
if(startBtn)startBtn.disabled=true;
if(resetBtn)resetBtn.disabled=true;
}
// Update footer button
const finishBtn=document.getElementById(â€˜btn-finish-workoutâ€™);
if(isReview){
finishBtn.textContent=â€˜EDIT WORKOUTâ€™;
finishBtn.className=â€˜btn-done readyâ€™;
finishBtn.onclick=()=>enableEditMode();
} else {
finishBtn.textContent=â€˜FINISH WORKOUTâ€™;
finishBtn.className=â€˜btn-doneâ€™;
finishBtn.onclick=()=>finishWorkout();
}
// Hide timer bar in review mode
document.getElementById(â€˜timer-barâ€™).style.display=isReview?â€˜noneâ€™:â€˜flexâ€™;
goTo(â€˜workout-screenâ€™);
setTimeout(()=>{document.getElementById(â€˜workout-contentâ€™).scrollTop=0;},50);
}

function enableEditMode(){
currentWorkout.isReview=false;
currentWorkout.isEditing=true;
addedExercises=[];
// Enable all inputs
document.querySelectorAll(â€™#workout-content input, #workout-content select, #workout-content button.set-checkâ€™).forEach(el=>{
el.disabled=false;
});
// Enable row tracker buttons
const rowStartBtn=document.getElementById(â€˜row-start-btnâ€™);
if(rowStartBtn)rowStartBtn.disabled=false;
if(rowStartBtn?.nextElementSibling)rowStartBtn.nextElementSibling.disabled=false;
// Show date editor
const dateDisplay=document.getElementById(â€˜workout-date-displayâ€™);
const dateEdit=document.getElementById(â€˜workout-date-editâ€™);
if(dateDisplay)dateDisplay.style.display=â€˜noneâ€™;
if(dateEdit)dateEdit.style.display=â€˜blockâ€™;
// Show timer bar
document.getElementById(â€˜timer-barâ€™).style.display=â€˜flexâ€™;
// Add movement button (before row tracker)
const content=document.getElementById(â€˜workout-contentâ€™);
if(!document.getElementById(â€˜add-movement-btnâ€™)){
const addBtn=document.createElement(â€˜divâ€™);
addBtn.id=â€˜add-movement-btnâ€™;addBtn.className=â€˜btn-add-workoutâ€™;
addBtn.innerHTML=â€™<div class="btn-add-workout-text">+ ADD MOVEMENT</div>â€™;
addBtn.onclick=()=>openAddMovement();
const rowWrap=document.getElementById(â€˜row-tracker-wrapâ€™);
if(rowWrap){content.insertBefore(addBtn,rowWrap);}
else{content.appendChild(addBtn);}
}
// Update button to save
const finishBtn=document.getElementById(â€˜btn-finish-workoutâ€™);
finishBtn.textContent=â€˜SAVE CHANGESâ€™;
finishBtn.className=â€˜btn-done readyâ€™;
finishBtn.onclick=()=>saveEditedWorkout();
}

function updateWorkoutDate(newDate){
if(!newDate)return;
const info=state.completedDays[currentWorkout.logKey];
if(info){
// Update the log key as well
const oldLogKey=info.savedLogKey;
const newLogKey=`${newDate}_${currentWorkout.day}`;
if(oldLogKey && oldLogKey!==newLogKey && state.log[oldLogKey]){
state.log[newLogKey]=state.log[oldLogKey];
delete state.log[oldLogKey];
}
info.date=newDate;
info.savedLogKey=newLogKey;
currentWorkout.savedLogKey=newLogKey;
saveState();
}
}

function saveEditedWorkout(){
showConfirm(â€˜Save Changes?â€™,â€˜This will update your logged data for this session.â€™,â€˜Saveâ€™,()=>{
stopTimer();
const logEntry={};
// Collect all exercises from DOM
document.querySelectorAll(â€™#workout-content .exercise-itemâ€™).forEach(exEl=>{
const nameEl=exEl.querySelector(â€™.exercise-nameâ€™);
if(!nameEl)return;
const exName=nameEl.textContent.trim();
const sets=exEl.querySelectorAll(â€™.log-set-rowâ€™);
logEntry[exName]=[];
sets.forEach(setRow=>{
const wInput=setRow.querySelector(â€™.log-inputâ€™);
const rSelect=setRow.querySelector(â€™.rpe-selectâ€™);
const chk=setRow.querySelector(â€™.set-checkâ€™);
logEntry[exName].push({
weight:wInput?.value||â€™â€™,
rpe:rSelect?.value||â€™â€™,
done:chk?.classList.contains(â€˜doneâ€™)||false
});
});
});
const info=state.completedDays[currentWorkout.logKey];
const logKey=info?info.savedLogKey:currentWorkout.savedLogKey;
if(logKey)state.log[logKey]=logEntry;
// Save row time if recorded
if(info && rowTimerSeconds>0){
info.rowTime=rowTimerSeconds;
if(!state.rowTimes)state.rowTimes=[];
const dateStr=info.date||new Date().toISOString().split(â€˜Tâ€™)[0];
state.rowTimes=state.rowTimes.filter(e=>e.date!==dateStr);
state.rowTimes.push({date:dateStr,seconds:rowTimerSeconds});
state.rowTimes.sort((a,b)=>a.date.localeCompare(b.date));
}
saveState();resetTimer();resetRowTimer();goTo(â€˜home-screenâ€™);
});
}

function undoDay(sk){
const info=state.completedDays[sk];
if(info && info.savedLogKey && state.log[info.savedLogKey]){
delete state.log[info.savedLogKey];
}
delete state.completedDays[sk];
saveState();initHomeScreen();
}

function getLastSessionWeights(dayLetter){
const result={};
const keys=Object.keys(state.log).filter(k=>k.endsWith(â€™_â€™+dayLetter)).sort().reverse();
if(!keys.length)return result;
const last=state.log[keys[0]];
Object.keys(last).forEach(exName=>{
const sets=last[exName];
const weights=sets.map(s=>parseFloat(s.weight)).filter(v=>!isNaN(v)&&v>0);
const rpes=sets.map(s=>parseFloat(s.rpe)).filter(v=>!isNaN(v)&&v>0);
if(!weights.length)return;
const maxW=Math.max(â€¦weights);
const avgRPE=rpes.length?rpes.reduce((a,b)=>a+b,0)/rpes.length:null;
let suggested=null;
if(avgRPE!=null){
if(avgRPE<=6)suggested=maxW+10;
else if(avgRPE<=8)suggested=maxW+5;
else if(avgRPE<=9)suggested=maxW;
else suggested=Math.max(maxW-5,0);
}
result[exName]={last:maxW,avgRPE,suggested};
});
return result;
}

function onInputChange(exIdx,setIdx){
const w=document.getElementById(`w-${exIdx}-${setIdx}`);
const r=document.getElementById(`r-${exIdx}-${setIdx}`);
w.classList.toggle(â€˜filledâ€™,!!w.value);
r.classList.toggle(â€˜filledâ€™,!!r.value);
updateProgress();
}

function toggleSetDone(exIdx,setIdx){
const chk=document.getElementById(`chk-${exIdx}-${setIdx}`);
const done=chk.classList.toggle(â€˜doneâ€™);chk.textContent=done?â€˜âœ“â€™:â€˜â—‹â€™;updateProgress();
}

function updateProgress(){
let total=0,done=0;
document.querySelectorAll(â€™#workout-content .exercise-itemâ€™).forEach(exEl=>{
exEl.querySelectorAll(â€™.set-checkâ€™).forEach(chk=>{
total++;if(chk.classList.contains(â€˜doneâ€™))done++;
});
});
const pct=total>0?done/total*100:0;
document.getElementById(â€˜workout-progress-fillâ€™).style.width=pct+â€™%â€™;
document.getElementById(â€˜top-progress-fillâ€™).style.width=pct+â€™%â€™;
document.getElementById(â€˜top-progress-labelâ€™).textContent=`${done} / ${total} SETS`;
document.getElementById(â€˜btn-finish-workoutâ€™).classList.toggle(â€˜readyâ€™,done>0);
}

function finishWorkout(){
showConfirm(â€˜Complete Workout?â€™,â€˜This will mark the session as done and save your log.â€™,â€˜Completeâ€™,()=>{
stopTimer();
const dd=PLAN.months[currentWorkout.month].days[currentWorkout.day];
const logEntry={};let totalWeight=0,setsLogged=0;
// Collect from plan exercises
dd.exercises.forEach((ex,exIdx)=>{
logEntry[ex.name]=[];
for(let s=0;s<(ex.sets||1);s++){
const w=document.getElementById(`w-${exIdx}-${s}`)?.value||â€™â€™;
const r=document.getElementById(`r-${exIdx}-${s}`)?.value||â€™â€™;
const done=document.getElementById(`chk-${exIdx}-${s}`)?.classList.contains(â€˜doneâ€™)||false;
logEntry[ex.name].push({weight:w,rpe:r,done});
if(w){totalWeight+=parseFloat(w)||0;setsLogged++;}
}
});
// Collect from added exercises
const baseIdx=dd.exercises.length;
addedExercises.forEach((ex,ai)=>{
const exIdx=baseIdx+ai;
logEntry[ex.name]=logEntry[ex.name]||[];
for(let s=0;s<(ex.sets||1);s++){
const w=document.getElementById(`w-${exIdx}-${s}`)?.value||â€™â€™;
const r=document.getElementById(`r-${exIdx}-${s}`)?.value||â€™â€™;
const done=document.getElementById(`chk-${exIdx}-${s}`)?.classList.contains(â€˜doneâ€™)||false;
logEntry[ex.name].push({weight:w,rpe:r,done});
if(w){totalWeight+=parseFloat(w)||0;setsLogged++;}
}
});
const dateStr=new Date().toISOString().split(â€˜Tâ€™)[0];
const savedLogKey=`${dateStr}_${currentWorkout.day}`;
state.log[savedLogKey]=logEntry;
state.completedDays[currentWorkout.logKey]={date:dateStr,savedLogKey,rowTime:rowTimerSeconds>0?rowTimerSeconds:null};
// Also save row time to global row tracker if timer was used
if(rowTimerSeconds>0){
if(!state.rowTimes)state.rowTimes=[];
state.rowTimes=state.rowTimes.filter(e=>e.date!==dateStr);
state.rowTimes.push({date:dateStr,seconds:rowTimerSeconds});
state.rowTimes.sort((a,b)=>a.date.localeCompare(b.date));
}
saveState();
document.getElementById(â€˜complete-titleâ€™).innerHTML=â€˜SESSION<br>DONEâ€™;
document.getElementById(â€˜complete-subâ€™).textContent=`Month ${currentWorkout.month}, Day ${currentWorkout.day} â€” logged âœ“`;
const avgW=setsLogged>0?Math.round(totalWeight/setsLogged):0;
let exDone=0;
document.querySelectorAll(â€™#workout-content .exercise-itemâ€™).forEach(el=>{
if(el.querySelector(â€™.set-check.doneâ€™))exDone++;
});
const timeStr=formatTime(timerSeconds);
const rowStr=rowTimerSeconds>0?formatRowTime(rowTimerSeconds):â€™â€”â€™;
document.getElementById(â€˜complete-statsâ€™).innerHTML=`<div class="complete-stat"><div class="complete-stat-val">${timeStr}</div><div class="complete-stat-label">Duration</div></div><div class="complete-stat"><div class="complete-stat-val">${setsLogged}</div><div class="complete-stat-label">Sets Logged</div></div><div class="complete-stat"><div class="complete-stat-val">${avgW||'â€”'}</div><div class="complete-stat-label">Avg Weight</div></div><div class="complete-stat"><div class="complete-stat-val" style="color:var(--phase3)">${rowStr}</div><div class="complete-stat-label">1km Row</div></div>`;
resetTimer();goTo(â€˜complete-screenâ€™);
});
}

function initBenchmarkScreen(){
const content=document.getElementById(â€˜benchmark-contentâ€™);content.innerHTML=â€™â€™;
const phases=[â€˜m1â€™,â€˜m4â€™,â€˜m8â€™,â€˜m12â€™],phaseLabels=[â€˜Month 1â€™,â€˜Month 4â€™,â€˜Month 8â€™,â€˜Month 12â€™];
BENCHMARKS.forEach(lift=>{
const vals=state.benchmarks[lift.key]||{};
const div=document.createElement(â€˜divâ€™);div.className=â€˜benchmark-liftâ€™;
const cellsHTML=phases.map((p,pi)=>{
const val=vals[p]||â€™â€™;
const delta=pi>0&&vals[phases[0]]&&val?(parseFloat(val)-parseFloat(vals[phases[0]])):null;
const deltaHTML=delta!=null&&delta!==0?`<div class="bpc-delta">${delta>0?'+':''}${delta} lbs</div>`:â€™â€™;
return `<div><div class="bpc-label">${phaseLabels[pi]}</div><input type="number" class="bpc-input ${val?'filled':''}" value="${val}" placeholder="â€”" onchange="saveBenchmark('${lift.key}','${p}',this.value)" oninput="this.classList.toggle('filled',!!this.value)" onfocus="this.select()">${deltaHTML}</div>`;
}).join(â€™â€™);
div.innerHTML=`<div class="benchmark-lift-name">${lift.name}</div><div class="benchmark-phases">${cellsHTML}</div>`;
content.appendChild(div);
});
}

function saveBenchmark(key,phase,value){
if(!state.benchmarks[key])state.benchmarks[key]={};
state.benchmarks[key][phase]=value;saveState();initBenchmarkScreen();
}

function initHistoryScreen(){
const content=document.getElementById(â€˜history-contentâ€™);content.innerHTML=â€™â€™;
const keys=Object.keys(state.log).sort().reverse();
if(!keys.length){content.innerHTML=â€™<div class="empty-state"><div class="empty-state-icon">â—³</div><div class="empty-state-text">No sessions logged yet.<br>Complete your first workout to see history here.</div></div>â€™;return;}
keys.forEach(key=>{
const parts=key.split(â€™_â€™);const day=parts[parts.length-1];const date=parts.slice(0,3).join(â€™-â€™);
const entry=state.log[key];const exercises=Object.keys(entry);
const dateObj=new Date(date+â€˜T12:00:00â€™);
const dateStr=dateObj.toLocaleDateString(â€˜en-USâ€™,{weekday:â€˜shortâ€™,month:â€˜shortâ€™,day:â€˜numericâ€™});
const div=document.createElement(â€˜divâ€™);div.className=â€˜history-sessionâ€™;
// Calculate summary stats
let totalSets=0,completedSets=0,topWeight=0;
exercises.forEach(exName=>{
const sets=entry[exName];
sets.forEach(s=>{totalSets++;if(s.done)completedSets++;const w=parseFloat(s.weight);if(!isNaN(w)&&w>topWeight)topWeight=w;});
});
let exHTML=exercises.slice(0,4).map(exName=>{
const sets=entry[exName];
const weights=sets.map(s=>s.weight).filter(Boolean);
const maxW=weights.length?Math.max(â€¦weights.map(Number)):null;
const rpes=sets.map(s=>s.rpe).filter(Boolean);
const avgRPE=rpes.length?(rpes.reduce((a,b)=>a+Number(b),0)/rpes.length).toFixed(1):null;
const val=[maxW?maxW+â€™ lbsâ€™:null,avgRPE?â€˜RPE â€˜+avgRPE:null].filter(Boolean).join(â€™ Â· â€˜);
return `<div class="history-exercise-row"><div class="history-ex-name">${exName}</div><div class="history-ex-vals">${val||'â€”'}</div></div>`;
}).join(â€™â€™);
if(exercises.length>4)exHTML+=`<div class="history-exercise-row"><div class="history-ex-name" style="color:var(--text-muted)">+${exercises.length-4} more</div></div>`;
div.innerHTML=`<div class="history-session-header"><div class="history-session-title">Day ${day}</div><div style="display:flex;align-items:center;gap:8px"><div class="history-session-date">${dateStr}</div><div style="color:var(--text-muted);font-size:14px">â†’</div></div></div>${exHTML}`;
div.onclick=()=>showHistoryDetail(key);
content.appendChild(div);
});
}

function showHistoryDetail(logKey){
const parts=logKey.split(â€™_â€™);const day=parts[parts.length-1];const date=parts.slice(0,3).join(â€™-â€™);
const entry=state.log[logKey];
if(!entry)return;
const dateObj=new Date(date+â€˜T12:00:00â€™);
const dateStr=dateObj.toLocaleDateString(â€˜en-USâ€™,{weekday:â€˜longâ€™,month:â€˜longâ€™,day:â€˜numericâ€™,year:â€˜numericâ€™});
const exercises=Object.keys(entry);
const content=document.getElementById(â€˜history-contentâ€™);
content.innerHTML=â€™â€™;
// Back button
const backBtn=document.createElement(â€˜buttonâ€™);
backBtn.className=â€˜workout-backâ€™;backBtn.textContent=â€˜â† All Sessionsâ€™;
backBtn.onclick=()=>initHistoryScreen();
content.appendChild(backBtn);
// Header
const header=document.createElement(â€˜divâ€™);
header.style.cssText=â€˜margin-bottom:20pxâ€™;
header.innerHTML=`<div style="font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:4px;color:var(--text-muted);text-transform:uppercase;margin-bottom:3px">DAY ${day}</div><div style="font-family:var(--bc);font-size:28px;font-weight:900;line-height:1;margin-bottom:6px">${dateStr.toUpperCase()}</div>`;
content.appendChild(header);
// Summary stats
let totalSets=0,completedSets=0,topWeight=0,allWeights=[];
exercises.forEach(exName=>{
entry[exName].forEach(s=>{
totalSets++;if(s.done)completedSets++;
const w=parseFloat(s.weight);if(!isNaN(w)&&w>0){allWeights.push(w);if(w>topWeight)topWeight=w;}
});
});
const avgW=allWeights.length?Math.round(allWeights.reduce((a,b)=>a+b,0)/allWeights.length):0;
const statsDiv=document.createElement(â€˜divâ€™);
statsDiv.style.cssText=â€˜display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:20pxâ€™;
statsDiv.innerHTML=`<div style="background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:12px;text-align:center"><div style="font-family:var(--bc);font-size:22px;font-weight:900;color:var(--accent)">${completedSets}/${totalSets}</div><div style="font-size:9px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase;margin-top:2px">Sets Done</div></div><div style="background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:12px;text-align:center"><div style="font-family:var(--bc);font-size:22px;font-weight:900;color:var(--accent)">${topWeight||'â€”'}</div><div style="font-size:9px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase;margin-top:2px">Top Weight</div></div><div style="background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:12px;text-align:center"><div style="font-family:var(--bc);font-size:22px;font-weight:900;color:var(--accent)">${avgW||'â€”'}</div><div style="font-size:9px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase;margin-top:2px">Avg Weight</div></div>`;
content.appendChild(statsDiv);
// Each exercise
exercises.forEach(exName=>{
const sets=entry[exName];
const exDiv=document.createElement(â€˜divâ€™);
exDiv.style.cssText=â€˜background:var(â€“surface);border:1px solid var(â€“border);border-radius:10px;padding:14px 16px;margin-bottom:10pxâ€™;
let setsHTML=sets.map((s,i)=>{
const w=s.weight||â€™â€”â€™;
const r=s.rpe?`RPE ${s.rpe}`:â€™â€™;
const done=s.done;
const wColor=s.weight?â€˜var(â€“accent)â€™:â€˜var(â€“text-muted)â€™;
const checkMark=done?â€™<span style="color:var(--accent);font-size:13px">âœ“</span>â€™:â€™<span style="color:var(--text-muted);font-size:13px">â—‹</span>â€™;
return `<div style="display:flex;align-items:center;gap:10px;padding:6px 0;${i>0?'border-top:1px solid var(--border)':''}"><div style="font-family:var(--bc);font-size:11px;font-weight:700;color:var(--text-muted);width:22px;text-align:center">S${i+1}</div><div style="flex:1;font-family:var(--bc);font-size:17px;font-weight:700;color:${wColor}">${w}${s.weight?' lbs':''}</div><div style="font-size:11px;color:var(--text-dim);width:50px;text-align:center">${r}</div>${checkMark}</div>`;
}).join(â€™â€™);
const safeExName=exName.replace(/â€™/g,â€\â€™â€);
exDiv.innerHTML=`<div style="font-family:var(--bc);font-size:18px;font-weight:900;text-transform:uppercase;margin-bottom:10px;color:#fff;letter-spacing:-0.3px;cursor:pointer;-webkit-tap-highlight-color:rgba(232,255,0,0.1)" onclick="showExHistory('${safeExName}')">${exName}</div>${setsHTML}`;
content.appendChild(exDiv);
});
}

// â€“â€“ Weight Tracking â€“â€“
function initWeightScreen(){
document.getElementById(â€˜weight-date-inputâ€™).value=new Date().toISOString().split(â€˜Tâ€™)[0];
renderWeightScreen();
}

function logWeight(){
const val=parseFloat(document.getElementById(â€˜weight-inputâ€™).value);
const date=document.getElementById(â€˜weight-date-inputâ€™).value;
if(!val||!date)return;
if(!state.weightLog)state.weightLog=[];
state.weightLog=state.weightLog.filter(e=>e.date!==date);
state.weightLog.push({date,weight:val});
state.weightLog.sort((a,b)=>a.date.localeCompare(b.date));
saveState();
document.getElementById(â€˜weight-inputâ€™).value=â€™â€™;
renderWeightScreen();
}

function deleteWeight(date){
state.weightLog=state.weightLog.filter(e=>e.date!==date);
saveState();renderWeightScreen();
}

function renderWeightScreen(){
const log=(state.weightLog||[]).slice().sort((a,b)=>a.date.localeCompare(b.date));
const chartWrap=document.getElementById(â€˜weight-chart-wrapâ€™);
const logLabel=document.getElementById(â€˜weight-log-labelâ€™);
const logList=document.getElementById(â€˜weight-log-listâ€™);
if(!log.length){
chartWrap.style.display=â€˜noneâ€™;logLabel.style.display=â€˜noneâ€™;
logList.innerHTML=â€™<div class="empty-state"><div class="empty-state-icon">âš–</div><div class="empty-state-text">No entries yet.<br>Log your first weigh-in above.</div></div>â€™;
return;
}
chartWrap.style.display=â€˜blockâ€™;logLabel.style.display=â€˜blockâ€™;
const weights=log.map(e=>e.weight);
const first=weights[0],last=weights[weights.length-1];
const min=Math.min(â€¦weights),max=Math.max(â€¦weights);
const change=+(last-first).toFixed(1);
const changeStr=(change>0?â€™+â€™:â€™â€™)+change;
const changeColor=change>0?â€˜var(â€“green)â€™:change<0?â€˜var(â€“red)â€™:â€˜var(â€“accent)â€™;
document.getElementById(â€˜weight-chart-subâ€™).textContent=`${log.length} weigh-in${log.length!==1?'s':''}`;
document.getElementById(â€˜weight-chart-statsâ€™).innerHTML=`<div class="wcs"><div class="wcs-val">${last}</div><div class="wcs-label">Current</div></div><div class="wcs"><div class="wcs-val" style="color:${changeColor}">${changeStr}</div><div class="wcs-label">Change</div></div><div class="wcs"><div class="wcs-val">${first}</div><div class="wcs-label">Start</div></div>`;
const canvas=document.getElementById(â€˜weight-chartâ€™);
const dpr=window.devicePixelRatio||1;
const displayW=canvas.parentElement.clientWidth-32,displayH=180;
canvas.style.width=displayW+â€˜pxâ€™;canvas.style.height=displayH+â€˜pxâ€™;
canvas.width=displayW*dpr;canvas.height=displayH*dpr;
const ctx=canvas.getContext(â€˜2dâ€™);ctx.scale(dpr,dpr);
const pad={top:16,right:16,bottom:28,left:42};
const W=displayW-pad.left-pad.right,H=displayH-pad.top-pad.bottom;
const range=max-min||1;const yMin=min-range*0.1,yMax=max+range*0.1;
const xPos=i=>pad.left+(log.length>1?i/(log.length-1)*W:W/2);
const yPos=v=>pad.top+H-(v-yMin)/(yMax-yMin)*H;
ctx.strokeStyle=â€™#2a2a2aâ€™;ctx.lineWidth=1;
for(let i=0;i<=4;i++){
const y=pad.top+i*(H/4);
ctx.beginPath();ctx.moveTo(pad.left,y);ctx.lineTo(pad.left+W,y);ctx.stroke();
ctx.fillStyle=â€™#555â€™;ctx.font=â€˜10px sans-serifâ€™;ctx.textAlign=â€˜rightâ€™;
ctx.fillText((yMax-(i/4)*(yMax-yMin)).toFixed(1),pad.left-5,y+4);
}
const labelIdxs=log.length<=6?log.map((_,i)=>i):[0,â€¦[1,2,3].map(i=>Math.round(i*(log.length-1)/3)),log.length-1].filter((v,i,a)=>a.indexOf(v)===i);
ctx.fillStyle=â€™#555â€™;ctx.textAlign=â€˜centerâ€™;ctx.font=â€˜9px sans-serifâ€™;
labelIdxs.forEach(i=>{const d=new Date(log[i].date+â€˜T12:00:00â€™);ctx.fillText(`${d.getMonth()+1}/${d.getDate()}`,xPos(i),pad.top+H+18);});
if(log.length>1){
const grad=ctx.createLinearGradient(0,pad.top,0,pad.top+H);
grad.addColorStop(0,â€˜rgba(232,255,0,0.18)â€™);grad.addColorStop(1,â€˜rgba(232,255,0,0)â€™);
ctx.beginPath();ctx.moveTo(xPos(0),yPos(log[0].weight));
log.forEach((e,i)=>{if(i>0)ctx.lineTo(xPos(i),yPos(e.weight));});
ctx.lineTo(xPos(log.length-1),pad.top+H);ctx.lineTo(xPos(0),pad.top+H);ctx.closePath();ctx.fillStyle=grad;ctx.fill();
}
ctx.beginPath();ctx.strokeStyle=â€™#e8ff00â€™;ctx.lineWidth=2;ctx.lineJoin=â€˜roundâ€™;ctx.lineCap=â€˜roundâ€™;
log.forEach((e,i)=>{i===0?ctx.moveTo(xPos(i),yPos(e.weight)):ctx.lineTo(xPos(i),yPos(e.weight));});ctx.stroke();
log.forEach((e,i)=>{ctx.beginPath();ctx.arc(xPos(i),yPos(e.weight),3.5,0,Math.PI*2);ctx.fillStyle=â€™#e8ff00â€™;ctx.fill();});
const reversed=[â€¦log].reverse();
logList.innerHTML=reversed.map((e,i)=>{
const prev=reversed[i+1];const delta=prev?+(e.weight-prev.weight).toFixed(1):null;
const deltaHTML=delta!=null?`<span class="weight-log-delta" style="color:${delta>0?'var(--green)':delta<0?'var(--red)':'var(--text-muted)'}">${delta>0?'+':''}${delta}</span>`:â€™â€™;
const d=new Date(e.date+â€˜T12:00:00â€™);
return `<div class="weight-log-item"><div class="weight-log-date">${d.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'})}</div><div style="display:flex;align-items:baseline;gap:2px"><div class="weight-log-val">${e.weight}</div><div style="font-size:11px;color:var(--text-muted)">lbs</div>${deltaHTML}<button class="weight-log-delete" onclick="deleteWeight('${e.date}')" title="Delete">Ã—</button></div></div>`;
}).join(â€™â€™);
}

// â€“â€“ Settings â€“â€“
function initSettingsScreen(){
const sub=document.getElementById(â€˜settings-start-date-subâ€™);
if(state.startDate){const d=new Date(state.startDate+â€˜T12:00:00â€™);sub.textContent=â€˜Started â€˜+d.toLocaleDateString(â€˜en-USâ€™,{month:â€˜longâ€™,day:â€˜numericâ€™,year:â€˜numericâ€™});}
else sub.textContent=â€˜Not setâ€™;
}
function exportData(){
const blob=new Blob([JSON.stringify(state,null,2)],{type:â€˜application/jsonâ€™});
const url=URL.createObjectURL(blob);const a=document.createElement(â€˜aâ€™);
a.href=url;a.download=`stefan-workout-backup-${new Date().toISOString().split('T')[0]}.json`;
document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);
}
function importData(event){
const file=event.target.files[0];if(!file)return;
const reader=new FileReader();
reader.onload=async(e)=>{
try{
const imported=JSON.parse(e.target.result);
if(!imported||typeof imported!==â€˜objectâ€™)throw 0;
if(!confirm(â€˜Import this backup? This will replace all current data.â€™))return;
state=imported;await saveState();initHomeScreen();alert(â€˜Data imported successfully!â€™);navTo(â€˜home-screenâ€™,â€˜nav-homeâ€™);
}catch(err){alert(â€˜Could not read backup file.â€™);}
};
reader.readAsText(file);event.target.value=â€™â€™;
}
function changeStartDate(){
const newDate=prompt(â€˜Enter new start date (YYYY-MM-DD):â€™,state.startDate||â€™â€™);
if(!newDate||newDate===state.startDate)return;
if(!/^\d{4}-\d{2}-\d{2}$/.test(newDate)){alert(â€˜Invalid date format. Use YYYY-MM-DDâ€™);return;}
state.startDate=newDate;saveState();initSettingsScreen();alert(â€˜Start date updated.â€™);
}
function resetAllData(){
if(!confirm(â€˜Are you sure? This will delete ALL your workout logs, PRs, weight entries, and progress. This cannot be undone.â€™))return;
if(!confirm(â€˜Really sure? Export a backup first if you want to keep your data.â€™))return;
state={startDate:state.startDate,log:{},benchmarks:{},completedDays:{},weightLog:[]};
saveState();alert(â€˜All data cleared.â€™);navTo(â€˜home-screenâ€™,â€˜nav-homeâ€™);
}

// â€“â€“ Confirm modal â€“â€“
let confirmCallback=null;
function showConfirm(title,body,confirmLabel,onConfirm){
document.getElementById(â€˜modal-titleâ€™).textContent=title;
document.getElementById(â€˜modal-bodyâ€™).textContent=body;
document.getElementById(â€˜modal-confirm-btnâ€™).textContent=confirmLabel;
confirmCallback=onConfirm;
document.getElementById(â€˜confirm-modalâ€™).classList.add(â€˜activeâ€™);
}
function closeConfirm(){document.getElementById(â€˜confirm-modalâ€™).classList.remove(â€˜activeâ€™);confirmCallback=null;}
document.getElementById(â€˜confirm-modalâ€™).addEventListener(â€˜clickâ€™,function(e){if(e.target===this)closeConfirm();});
function confirmAction(){if(confirmCallback)confirmCallback();closeConfirm();}

// â€“â€“ Plan browser â€“â€“
function initPlanScreen(){
const content=document.getElementById(â€˜plan-contentâ€™);content.innerHTML=â€™â€™;
document.getElementById(â€˜plan-screen-titleâ€™).textContent=â€˜The Planâ€™;
let totalRequired=0,totalDone=0;
const phaseProgress=PHASES.map(phase=>{
let req=0,done=0;
phase.months.forEach(m=>{[1,2,3,4].forEach(w=>{[â€˜Aâ€™,â€˜Bâ€™].forEach(d=>{req++;if(state.completedDays[`${m}_${w}_${d}`])done++;});});});
totalRequired+=req;totalDone+=done;return{phase,req,done};
});
const dotC=[â€˜var(â€“phase1)â€™,â€˜var(â€“phase2)â€™,â€˜var(â€“phase3)â€™],barC=[â€™#e8ff00â€™,â€™#ff8c00â€™,â€™#00d4ffâ€™],pcC=[â€˜phase-1â€™,â€˜phase-2â€™,â€˜phase-3â€™];
const phaseRowsHTML=phaseProgress.map((pp,pi)=>`<div class="plan-phase-row"><div class="plan-phase-row-label" style="color:${dotC[pi]}">P${pp.phase.num}</div><div class="plan-phase-mini-track"><div class="plan-phase-mini-fill" style="width:${pp.req>0?Math.round(pp.done/pp.req*100):0}%;background:${barC[pi]}"></div></div><div class="plan-phase-row-count">${pp.done}/${pp.req}</div></div>`).join(â€™â€™);
const pw=document.createElement(â€˜divâ€™);pw.className=â€˜plan-progress-wrapâ€™;
pw.innerHTML=`<div class="plan-progress-top"><div class="plan-progress-title">Overall Progress</div><div class="plan-progress-count">${totalDone} / ${totalRequired} sessions</div></div><div class="plan-overall-track"><div class="plan-overall-fill" style="width:${totalRequired>0?Math.round(totalDone/totalRequired*100):0}%"></div></div><div class="plan-phase-rows">${phaseRowsHTML}</div>`;
content.appendChild(pw);
PHASES.forEach((phase,pi)=>{
const block=document.createElement(â€˜divâ€™);block.className=â€˜phase-blockâ€™;
const monthCards=phase.months.map(m=>{
const md=PLAN.months[m];let mReq=0,mDone=0;
[1,2,3,4].forEach(w=>[â€˜Aâ€™,â€˜Bâ€™].forEach(d=>{mReq++;if(state.completedDays[`${m}_${w}_${d}`])mDone++;}));
return `<div class="month-card ${pcC[pi]}-card" onclick="showMonthDetail(${m})"><div class="month-card-num">Month ${m}</div><div class="month-card-name">${md.name}</div><div style="margin-top:8px;height:3px;background:var(--surface3);border-radius:2px;overflow:hidden"><div style="height:100%;width:${Math.round(mDone/mReq*100)}%;background:${barC[pi]};border-radius:2px"></div></div><div class="month-card-arrow" style="margin-top:6px">${mDone}/${mReq} Â· View â†’</div></div>`;
}).join(â€™â€™);
block.innerHTML=`<div class="phase-block-header"><div class="phase-dot" style="background:${dotC[pi]}"></div><div class="phase-block-title ${pcC[pi]}">Phase ${phase.num} â€” ${phase.name}</div></div><div class="month-grid">${monthCards}</div>`;
content.appendChild(block);
});
}

function showMonthDetail(monthNum){
const md=PLAN.months[monthNum];const phase=PHASES.find(p=>p.months.includes(monthNum));
const focuses=[
[â€˜Orientationâ€™,â€˜Technique Lock-Inâ€™,â€˜Progressive Loadâ€™,â€˜Deloadâ€™],[â€˜Volume Increaseâ€™,â€˜Progressive Overloadâ€™,â€˜Intensity Surgeâ€™,â€˜Deloadâ€™],
[â€˜5x5 Strength Startâ€™,â€˜Load Progressionâ€™,â€˜Peak Setsâ€™,â€˜Deload + Assessâ€™],[â€˜Peakingâ€™,â€˜PR Attemptsâ€™,â€˜Phase Testsâ€™,â€˜Phase Closeâ€™],
[â€˜Establish Weightsâ€™,â€˜Progressive Overloadâ€™,â€˜Intensity Surgeâ€™,â€˜Deloadâ€™],[â€˜Strength Loadingâ€™,â€˜Progressive Overloadâ€™,â€˜Intensity Surgeâ€™,â€˜Deloadâ€™],
[â€˜Intensity Peakâ€™,â€˜Load Progressionâ€™,â€˜Peak Setsâ€™,â€˜Deloadâ€™],[â€˜Full Testâ€™,â€˜Full Testâ€™,â€˜Full Testâ€™,â€˜Deloadâ€™],
[â€˜Transitionâ€™,â€˜Buildâ€™,â€˜Peakâ€™,â€˜Deloadâ€™],[â€˜Definition Pushâ€™,â€˜Buildâ€™,â€˜Peakâ€™,â€˜Deloadâ€™],
[â€˜Final Buildâ€™,â€˜Final Buildâ€™,â€˜Peakâ€™,â€˜Deloadâ€™],[â€˜Year-End Peakâ€™,â€˜PR Testâ€™,â€˜Celebrationâ€™,â€˜Deloadâ€™]
][monthNum-1]||[â€˜Week 1â€™,â€˜Week 2â€™,â€˜Week 3â€™,â€˜Week 4â€™];
const content=document.getElementById(â€˜plan-contentâ€™);
content.innerHTML=`<button class="plan-back-btn" onclick="initPlanScreen();document.getElementById('plan-screen-title').textContent='The Plan'">â† All Phases</button><div style="margin-bottom:6px"><span class="plan-screen-tag">Phase ${phase.num} Â· Month ${monthNum}</span></div><div style="font-family:var(--bc);font-size:28px;font-weight:900;margin-bottom:20px">${md.name.toUpperCase()}</div><div id="weeks-list"></div>`;
document.getElementById(â€˜plan-screen-titleâ€™).textContent=`Month ${monthNum}`;
const weeksList=document.getElementById(â€˜weeks-listâ€™);
[1,2,3,4].forEach(w=>{
const block=document.createElement(â€˜divâ€™);block.className=â€˜week-blockâ€™;
const bodyId=`wb-body-${w}`,chevId=`wb-chev-${w}`;
block.innerHTML=`<div class="week-block-header" onclick="toggleWeek('${bodyId}','${chevId}')"><div><div class="week-block-title">Week ${w}${w===4?' â€” Deload':''}</div><div class="week-block-meta">${focuses[w-1]}</div></div><div class="week-block-chevron" id="${chevId}">â€º</div></div><div class="week-block-body" id="${bodyId}">${buildDayTabs(monthNum,w)}</div>`;
weeksList.appendChild(block);
});
}

function toggleWeek(bodyId,chevId){
document.getElementById(bodyId).classList.toggle(â€˜openâ€™);
document.getElementById(chevId).classList.toggle(â€˜openâ€™);
}

function buildDayTabs(monthNum,week){
const days=[â€˜Aâ€™,â€˜Bâ€™,â€˜Câ€™];
const tabsHTML=days.map((d,i)=>`<div class="day-tab${i===0?' active':''}" onclick="switchDayTab(${monthNum},${week},'${d}',this)">Day ${d}</div>`).join(â€™â€™);
const panelsHTML=days.map((d,i)=>{
const dd=PLAN.months[monthNum].days[d];
const exRows=dd.exercises.map(ex=>`<div class="plan-exercise-row"><div class="plan-ex-name">${ex.name}${ex.superset?'<span class="plan-ex-ss">SS</span>':''}</div><div class="plan-ex-specs"><div class="plan-ex-spec"><div class="plan-ex-spec-label">Sets</div><div class="plan-ex-spec-val">${ex.sets||'â€”'}</div></div><div class="plan-ex-spec"><div class="plan-ex-spec-label">Reps</div><div class="plan-ex-spec-val">${ex.reps}</div></div><div class="plan-ex-spec"><div class="plan-ex-spec-label">Rest</div><div class="plan-ex-spec-val">${ex.rest}</div></div></div><div class="plan-ex-note">${ex.note}</div></div>`).join(â€™â€™);
const deloadNote=week===4?â€™<div style="font-size:12px;color:#ff8c00;background:#ff8c0011;border:1px solid #ff8c0033;border-radius:6px;padding:10px 12px;margin-bottom:12px">âš  Deload week â€” reduce all loads by 40%</div>â€™:â€™â€™;
const bonusNote=dd.bonus?â€™<div style="font-size:11px;color:var(--text-muted);margin-bottom:10px;letter-spacing:1px">OPTIONAL BONUS DAY</div>â€™:â€™â€™;
return `<div class="day-panel${i===0?' active':''}" id="panel-${monthNum}-${week}-${d}">${deloadNote}${bonusNote}${exRows}</div>`;
}).join(â€™â€™);
return `<div class="day-tab-strip">${tabsHTML}</div>${panelsHTML}`;
}

function switchDayTab(monthNum,week,day,tabEl){
tabEl.parentElement.querySelectorAll(â€™.day-tabâ€™).forEach(t=>t.classList.remove(â€˜activeâ€™));
tabEl.classList.add(â€˜activeâ€™);
[â€˜Aâ€™,â€˜Bâ€™,â€˜Câ€™].forEach(d=>{const p=document.getElementById(`panel-${monthNum}-${week}-${d}`);if(p)p.classList.toggle(â€˜activeâ€™,d===day);});
}

// â€“â€“ 1km Row Tracker â€“â€“
let rowTimerInterval=null,rowTimerSeconds=0,rowTimerRunning=false,rowTimeSaved=false;

function formatRowTime(s){
const m=Math.floor(s/60),sec=s%60,ms=0;
return `${m}:${String(sec).padStart(2,'0')}`;
}

function updateRowDisplay(){
const el=document.getElementById(â€˜row-timer-displayâ€™);
if(el)el.textContent=formatRowTime(rowTimerSeconds);
}

function toggleRowTimer(){
const btn=document.getElementById(â€˜row-start-btnâ€™);
if(rowTimerRunning){
// Stop
clearInterval(rowTimerInterval);rowTimerInterval=null;rowTimerRunning=false;
btn.textContent=â€˜RESUMEâ€™;btn.className=â€˜row-tracker-btn startâ€™;
// Auto-save the time
saveRowTime();
} else {
// Start
rowTimeSaved=false;
const savedEl=document.getElementById(â€˜row-saved-msgâ€™);
if(savedEl)savedEl.style.display=â€˜noneâ€™;
rowTimerRunning=true;
rowTimerInterval=setInterval(()=>{rowTimerSeconds++;updateRowDisplay();},1000);
btn.textContent=â€˜STOPâ€™;btn.className=â€˜row-tracker-btn stopâ€™;
}
}

function resetRowTimer(){
clearInterval(rowTimerInterval);rowTimerInterval=null;rowTimerRunning=false;rowTimerSeconds=0;rowTimeSaved=false;
updateRowDisplay();
const btn=document.getElementById(â€˜row-start-btnâ€™);
if(btn){btn.textContent=â€˜STARTâ€™;btn.className=â€˜row-tracker-btn startâ€™;}
const savedEl=document.getElementById(â€˜row-saved-msgâ€™);
if(savedEl)savedEl.style.display=â€˜noneâ€™;
}

function saveRowTime(){
if(rowTimerSeconds<=0||rowTimeSaved)return;
if(!state.rowTimes)state.rowTimes=[];
const dateStr=new Date().toISOString().split(â€˜Tâ€™)[0];
// Replace if same date
state.rowTimes=state.rowTimes.filter(e=>e.date!==dateStr);
state.rowTimes.push({date:dateStr,seconds:rowTimerSeconds});
state.rowTimes.sort((a,b)=>a.date.localeCompare(b.date));
rowTimeSaved=true;
saveState();
updateRowBest();
const savedEl=document.getElementById(â€˜row-saved-msgâ€™);
if(savedEl){savedEl.style.display=â€˜blockâ€™;savedEl.textContent=`âœ“ SAVED â€” ${formatRowTime(rowTimerSeconds)}`;}
}

function updateRowBest(){
const bestEl=document.getElementById(â€˜row-best-valâ€™);
const lastEl=document.getElementById(â€˜row-last-valâ€™);
if(!bestEl)return;
const times=(state.rowTimes||[]).map(t=>t.seconds).filter(s=>s>0);
if(!times.length){bestEl.textContent=â€™â€”â€™;if(lastEl)lastEl.textContent=â€™â€”â€™;return;}
const best=Math.min(â€¦times);
bestEl.textContent=formatRowTime(best);
if(lastEl){
const sorted=[â€¦(state.rowTimes||[])].sort((a,b)=>b.date.localeCompare(a.date));
lastEl.textContent=sorted.length?formatRowTime(sorted[0].seconds):â€™â€”â€™;
}
}

function buildRowTrackerHTML(){
const times=state.rowTimes||[];
const best=times.length?Math.min(â€¦times.map(t=>t.seconds)):null;
const sorted=[â€¦times].sort((a,b)=>b.date.localeCompare(a.date));
const last=sorted.length?sorted[0]:null;
return `<div class="row-tracker" id="row-tracker">
<div class="row-tracker-header"><div class="row-tracker-title">ğŸš£ 1KM ROW</div><div style="font-size:11px;color:var(--text-muted)">${times.length} session${times.length!==1?â€˜sâ€™:â€™â€™}</div></div>
<div class="row-tracker-time" id="row-timer-display">0:00</div>
<div class="row-tracker-controls">
<button class="row-tracker-btn start" id="row-start-btn" onclick="toggleRowTimer()">START</button>
<button class="row-tracker-btn reset" onclick="resetRowTimer()">RESET</button>
<button class="row-tracker-btn" style="border-color:var(--phase3);color:var(--phase3)" onclick="showRowHistory()">HISTORY</button>
</div>
<div id="row-saved-msg" class="row-tracker-saved" style="display:none"></div>
<div class="row-tracker-best">
<div><div class="row-tracker-best-label">Best Time</div><div class="row-tracker-best-val" id="row-best-val">${best?formatRowTime(best):â€™â€”â€™}</div></div>
<div style="text-align:right"><div class="row-tracker-best-label">Last Time</div><div class="row-tracker-best-val" id="row-last-val">${last?formatRowTime(last.seconds):â€™â€”â€™}</div></div>
</div>

  </div>`;
}

function showRowHistory(){
document.getElementById(â€˜ex-history-titleâ€™).textContent=â€˜1KM ROW TIMESâ€™;
const content=document.getElementById(â€˜ex-history-contentâ€™);content.innerHTML=â€™â€™;
const times=(state.rowTimes||[]).slice().sort((a,b)=>b.date.localeCompare(a.date));
if(!times.length){
content.innerHTML=â€™<div class="empty-state"><div class="empty-state-icon">ğŸš£</div><div class="empty-state-text">No row times recorded yet.<br>Use the timer in your workout to start tracking.</div></div>â€™;
document.getElementById(â€˜ex-history-overlayâ€™).classList.add(â€˜activeâ€™);return;
}
const best=Math.min(â€¦times.map(t=>t.seconds));
const bestEntry=times.find(t=>t.seconds===best);
// PR card
if(bestEntry){
const d=new Date(bestEntry.date+â€˜T12:00:00â€™);
const prDiv=document.createElement(â€˜divâ€™);prDiv.className=â€˜ex-history-prâ€™;prDiv.style.borderColor=â€˜var(â€“phase3)â€™;
prDiv.innerHTML=`<div><div class="ex-history-pr-label">Best Time</div><div style="font-size:12px;color:var(--text-dim);margin-top:2px">${d.toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'})}</div></div><div class="ex-history-pr-val" style="color:var(--phase3)">${formatRowTime(best)}</div>`;
content.appendChild(prDiv);
}
// Trend
if(times.length>=2){
const latest=times[0].seconds,first=times[times.length-1].seconds;
const diff=latest-first;
const trendColor=diff<0?â€˜var(â€“green)â€™:diff>0?â€˜var(â€“red)â€™:â€˜var(â€“text-muted)â€™;
const trendArrow=diff<0?â€˜â†“ Fasterâ€™:diff>0?â€˜â†‘ Slowerâ€™:â€˜â†’ Sameâ€™;
const trendDiv=document.createElement(â€˜divâ€™);
trendDiv.style.cssText=â€˜display:flex;justify-content:space-between;align-items:center;padding:10px 14px;background:var(â€“surface);border:1px solid var(â€“border);border-radius:10px;margin-bottom:16pxâ€™;
trendDiv.innerHTML=`<div><div style="font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase">Trend</div><div style="font-size:12px;color:var(--text-dim);margin-top:2px">${times.length} rows logged</div></div><div style="font-family:var(--bc);font-size:18px;font-weight:900;color:${trendColor}">${trendArrow} (${Math.abs(diff)}s)</div>`;
content.appendChild(trendDiv);
}
// List
const label=document.createElement(â€˜divâ€™);
label.style.cssText=â€˜font-family:var(â€“bc);font-size:10px;font-weight:700;letter-spacing:4px;color:var(â€“text-muted);text-transform:uppercase;margin-bottom:10pxâ€™;
label.textContent=â€˜ALL TIMESâ€™;
content.appendChild(label);
times.forEach((t,i)=>{
const d=new Date(t.date+â€˜T12:00:00â€™);
const dateStr=d.toLocaleDateString(â€˜en-USâ€™,{weekday:â€˜shortâ€™,month:â€˜shortâ€™,day:â€˜numericâ€™});
const isBest=t.seconds===best;
const prev=times[i+1];
const delta=prev?(t.seconds-prev.seconds):null;
const deltaHTML=delta!=null?`<span style="color:${delta<0?'var(--green)':delta>0?'var(--red)':'var(--text-muted)'};font-size:12px;margin-left:8px">${delta<0?'':'+'}${delta}s</span>`:â€™â€™;
const div=document.createElement(â€˜divâ€™);div.className=â€˜ex-history-sessionâ€™;
div.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center"><div><div style="font-size:12px;color:var(--text-dim)">${dateStr}</div></div><div style="display:flex;align-items:baseline"><div style="font-family:var(--bc);font-size:22px;font-weight:900;color:${isBest?'var(--phase3)':'var(--text)'}">${formatRowTime(t.seconds)}</div>${deltaHTML}${isBest?'<span style="font-size:10px;color:var(--phase3);margin-left:8px;font-weight:700">PR</span>':''}</div></div>`;
content.appendChild(div);
});
document.getElementById(â€˜ex-history-overlayâ€™).classList.add(â€˜activeâ€™);
}

// â€“â€“ Exercise History â€“â€“
function showExHistory(exName){
document.getElementById(â€˜ex-history-titleâ€™).textContent=exName;
const content=document.getElementById(â€˜ex-history-contentâ€™);content.innerHTML=â€™â€™;
// Search all logs for this exercise
const sessions=[];
Object.keys(state.log).forEach(logKey=>{
const entry=state.log[logKey];
if(entry[exName]){
const parts=logKey.split(â€™_â€™);const day=parts[parts.length-1];const date=parts.slice(0,3).join(â€™-â€™);
sessions.push({date,day,sets:entry[exName]});
}
});
sessions.sort((a,b)=>b.date.localeCompare(a.date));
if(!sessions.length){
content.innerHTML=â€™<div class="empty-state"><div class="empty-state-icon">â—³</div><div class="empty-state-text">No history for this exercise yet.<br>Complete a session with it to start tracking.</div></div>â€™;
document.getElementById(â€˜ex-history-overlayâ€™).classList.add(â€˜activeâ€™);
return;
}
// Find PR (max weight ever)
let prWeight=0,prDate=â€™â€™;
sessions.forEach(s=>{
s.sets.forEach(set=>{
const w=parseFloat(set.weight);
if(!isNaN(w)&&w>prWeight){prWeight=w;prDate=s.date;}
});
});
if(prWeight>0){
const prD=new Date(prDate+â€˜T12:00:00â€™);
const prDateStr=prD.toLocaleDateString(â€˜en-USâ€™,{month:â€˜shortâ€™,day:â€˜numericâ€™,year:â€˜numericâ€™});
const prDiv=document.createElement(â€˜divâ€™);prDiv.className=â€˜ex-history-prâ€™;
prDiv.innerHTML=`<div><div class="ex-history-pr-label">Personal Record</div><div style="font-size:12px;color:var(--text-dim);margin-top:2px">${prDateStr}</div></div><div class="ex-history-pr-val">${prWeight} lbs</div>`;
content.appendChild(prDiv);
}
// Trend: show last weights as a mini summary
const allMaxWeights=sessions.map(s=>{
const weights=s.sets.map(set=>parseFloat(set.weight)).filter(v=>!isNaN(v)&&v>0);
return weights.length?Math.max(â€¦weights):null;
}).filter(v=>v!==null);
if(allMaxWeights.length>=2){
const latest=allMaxWeights[0],first=allMaxWeights[allMaxWeights.length-1];
const diff=+(latest-first).toFixed(1);
const trendColor=diff>0?â€˜var(â€“green)â€™:diff<0?â€˜var(â€“red)â€™:â€˜var(â€“text-muted)â€™;
const trendArrow=diff>0?â€˜â†‘â€™:diff<0?â€˜â†“â€™:â€˜â†’â€™;
const trendDiv=document.createElement(â€˜divâ€™);
trendDiv.style.cssText=â€˜display:flex;justify-content:space-between;align-items:center;padding:10px 14px;background:var(â€“surface);border:1px solid var(â€“border);border-radius:10px;margin-bottom:16pxâ€™;
trendDiv.innerHTML=`<div><div style="font-family:var(--bc);font-size:11px;font-weight:700;letter-spacing:3px;color:var(--text-muted);text-transform:uppercase">Trend</div><div style="font-size:12px;color:var(--text-dim);margin-top:2px">${sessions.length} session${sessions.length!==1?'s':''}</div></div><div style="font-family:var(--bc);font-size:20px;font-weight:900;color:${trendColor}">${trendArrow} ${diff>0?'+':''}${diff} lbs</div>`;
content.appendChild(trendDiv);
}
// Label
const label=document.createElement(â€˜divâ€™);
label.style.cssText=â€˜font-family:var(â€“bc);font-size:10px;font-weight:700;letter-spacing:4px;color:var(â€“text-muted);text-transform:uppercase;margin-bottom:10pxâ€™;
label.textContent=â€˜SESSION LOGâ€™;
content.appendChild(label);
// Each session
sessions.forEach(s=>{
const d=new Date(s.date+â€˜T12:00:00â€™);
const dateStr=d.toLocaleDateString(â€˜en-USâ€™,{weekday:â€˜shortâ€™,month:â€˜shortâ€™,day:â€˜numericâ€™,year:â€˜numericâ€™});
const div=document.createElement(â€˜divâ€™);div.className=â€˜ex-history-sessionâ€™;
div.innerHTML=`<div class="ex-history-session-date">Day ${s.day} Â· ${dateStr}</div>`;
s.sets.forEach((set,i)=>{
const w=set.weight||â€™â€”â€™;
const wColor=set.weight?â€˜var(â€“accent)â€™:â€˜var(â€“text-muted)â€™;
const rpe=set.rpe?`RPE ${set.rpe}`:â€™â€™;
const check=set.done?â€™<span style="color:var(--accent)">âœ“</span>â€™:â€™<span style="color:var(--text-muted)">â—‹</span>â€™;
const row=document.createElement(â€˜divâ€™);row.className=â€˜ex-history-set-rowâ€™;
row.innerHTML=`<div class="ex-history-set-num">S${i+1}</div><div class="ex-history-set-weight" style="color:${wColor}">${w}${set.weight?' lbs':''}</div><div class="ex-history-set-rpe">${rpe}</div><div class="ex-history-set-check">${check}</div>`;
div.appendChild(row);
});
content.appendChild(div);
});
document.getElementById(â€˜ex-history-overlayâ€™).classList.add(â€˜activeâ€™);
}

function closeExHistory(){
document.getElementById(â€˜ex-history-overlayâ€™).classList.remove(â€˜activeâ€™);
}

// â€“â€“ Add Movement â€“â€“
const EXERCISE_DB=[
{cat:â€œBarbell Compoundâ€,items:[
{name:â€œBack Squatâ€,muscles:â€œQuads, Glutes, Coreâ€},
{name:â€œFront Squatâ€,muscles:â€œQuads, Core, Upper Backâ€},
{name:â€œOverhead Squatâ€,muscles:â€œFull Body, Mobilityâ€},
{name:â€œBarbell Bench Pressâ€,muscles:â€œChest, Triceps, Shouldersâ€},
{name:â€œIncline Barbell Pressâ€,muscles:â€œUpper Chest, Shouldersâ€},
{name:â€œClose-Grip Bench Pressâ€,muscles:â€œTriceps, Chestâ€},
{name:â€œFloor Pressâ€,muscles:â€œChest, Tricepsâ€},
{name:â€œOverhead Pressâ€,muscles:â€œShoulders, Triceps, Coreâ€},
{name:â€œPush Pressâ€,muscles:â€œShoulders, Triceps, Legsâ€},
{name:â€œBarbell Rowâ€,muscles:â€œBack, Biceps, Coreâ€},
{name:â€œPendlay Rowâ€,muscles:â€œBack, Lats, Coreâ€},
{name:â€œConventional Deadliftâ€,muscles:â€œPosterior Chain, Back, Glutesâ€},
{name:â€œRomanian Deadliftâ€,muscles:â€œHamstrings, Glutes, Lower Backâ€},
{name:â€œSumo Deadliftâ€,muscles:â€œGlutes, Quads, Inner Thighâ€},
{name:â€œTrap Bar Deadliftâ€,muscles:â€œQuads, Glutes, Backâ€},
{name:â€œHip Thrustâ€,muscles:â€œGlutes, Hamstringsâ€},
{name:â€œGood Morningâ€,muscles:â€œHamstrings, Lower Backâ€},
{name:â€œBarbell Lungeâ€,muscles:â€œQuads, Glutesâ€},
{name:â€œBarbell Curlâ€,muscles:â€œBicepsâ€},
{name:â€œSkull Crusherâ€,muscles:â€œTricepsâ€},
{name:â€œLandmine Pressâ€,muscles:â€œShoulders, Coreâ€},
{name:â€œLandmine Rowâ€,muscles:â€œBack, Bicepsâ€},
{name:â€œLandmine Rotationâ€,muscles:â€œCore, Obliquesâ€},
{name:â€œZercher Squatâ€,muscles:â€œQuads, Core, Upper Backâ€},
]},
{cat:â€œOlympic Liftsâ€,items:[
{name:â€œPower Cleanâ€,muscles:â€œFull Body, Explosiveâ€},
{name:â€œHang Power Cleanâ€,muscles:â€œHips, Traps, Full Bodyâ€},
{name:â€œClean & Jerkâ€,muscles:â€œFull Body, Explosiveâ€},
{name:â€œClean Pullâ€,muscles:â€œBack, Traps, Hipsâ€},
{name:â€œPower Snatchâ€,muscles:â€œFull Body, Shouldersâ€},
{name:â€œHang Power Snatchâ€,muscles:â€œHips, Shoulders, Full Bodyâ€},
{name:â€œSnatch-Grip High Pullâ€,muscles:â€œTraps, Upper Back, Hipsâ€},
{name:â€œJerk (split or push)â€,muscles:â€œShoulders, Triceps, Legsâ€},
{name:â€œClean & Pressâ€,muscles:â€œFull Bodyâ€},
]},
{cat:â€œDumbbellâ€,items:[
{name:â€œDumbbell Bench Pressâ€,muscles:â€œChest, Tricepsâ€},
{name:â€œIncline DB Pressâ€,muscles:â€œUpper Chest, Shouldersâ€},
{name:â€œDumbbell Rowâ€,muscles:â€œBack, Bicepsâ€},
{name:â€œSingle-Arm DB Pressâ€,muscles:â€œShoulders, Coreâ€},
{name:â€œArnold Pressâ€,muscles:â€œShoulders, Rotatorsâ€},
{name:â€œDumbbell Lateral Raiseâ€,muscles:â€œSide Deltsâ€},
{name:â€œDumbbell Front Raiseâ€,muscles:â€œFront Deltsâ€},
{name:â€œDumbbell Curlâ€,muscles:â€œBicepsâ€},
{name:â€œHammer Curlâ€,muscles:â€œBiceps, Forearmsâ€},
{name:â€œDumbbell Tricep Extensionâ€,muscles:â€œTricepsâ€},
{name:â€œDumbbell Flyâ€,muscles:â€œChestâ€},
{name:â€œGoblet Squatâ€,muscles:â€œQuads, Coreâ€},
{name:â€œDumbbell Lungeâ€,muscles:â€œQuads, Glutesâ€},
{name:â€œDumbbell Step-Upâ€,muscles:â€œQuads, Glutesâ€},
{name:â€œDumbbell Shrugâ€,muscles:â€œTrapsâ€},
{name:â€œDumbbell Pulloverâ€,muscles:â€œLats, Chestâ€},
{name:â€œDumbbell Thrusterâ€,muscles:â€œFull Bodyâ€},
{name:â€œSingle-Leg RDLâ€,muscles:â€œHamstrings, Balanceâ€},
{name:â€œRenegade Rowâ€,muscles:â€œBack, Coreâ€},
]},
{cat:â€œCables & Machinesâ€,items:[
{name:â€œCable Rowâ€,muscles:â€œBack, Bicepsâ€},
{name:â€œSeated Cable Rowâ€,muscles:â€œBack, Latsâ€},
{name:â€œCable Face Pullâ€,muscles:â€œRear Delts, Rotator Cuffâ€},
{name:â€œCable Flyâ€,muscles:â€œChestâ€},
{name:â€œCable Lateral Raiseâ€,muscles:â€œSide Deltsâ€},
{name:â€œCable Tricep Pushdownâ€,muscles:â€œTricepsâ€},
{name:â€œCable Curlâ€,muscles:â€œBicepsâ€},
{name:â€œCable Woodchopâ€,muscles:â€œCore, Obliquesâ€},
{name:â€œLat Pulldownâ€,muscles:â€œLats, Bicepsâ€},
{name:â€œLeg Pressâ€,muscles:â€œQuads, Glutesâ€},
{name:â€œLeg Extensionâ€,muscles:â€œQuadsâ€},
{name:â€œLeg Curlâ€,muscles:â€œHamstringsâ€},
{name:â€œHack Squatâ€,muscles:â€œQuads, Glutesâ€},
{name:â€œSmith Machine Squatâ€,muscles:â€œQuads, Glutesâ€},
{name:â€œChest Press Machineâ€,muscles:â€œChest, Tricepsâ€},
{name:â€œPec Deckâ€,muscles:â€œChestâ€},
{name:â€œReverse Pec Deckâ€,muscles:â€œRear Deltsâ€},
{name:â€œHip Abduction Machineâ€,muscles:â€œGlutes, Abductorsâ€},
{name:â€œHip Adduction Machineâ€,muscles:â€œAdductorsâ€},
{name:â€œCalf Raise Machineâ€,muscles:â€œCalvesâ€},
{name:â€œBelt Squatâ€,muscles:â€œQuads, Glutes â€” no spinal loadâ€},
]},
{cat:â€œBodyweight & Pull-Up Barâ€,items:[
{name:â€œPull-Upâ€,muscles:â€œLats, Bicepsâ€},
{name:â€œChin-Upâ€,muscles:â€œBiceps, Latsâ€},
{name:â€œWeighted Pull-Upâ€,muscles:â€œLats, Bicepsâ€},
{name:â€œWeighted Chin-Upâ€,muscles:â€œBiceps, Latsâ€},
{name:â€œDipsâ€,muscles:â€œChest, Tricepsâ€},
{name:â€œWeighted Dipâ€,muscles:â€œChest, Tricepsâ€},
{name:â€œPush-Upâ€,muscles:â€œChest, Tricepsâ€},
{name:â€œPlyometric Push-Upâ€,muscles:â€œChest, Powerâ€},
{name:â€œDiamond Push-Upâ€,muscles:â€œTriceps, Chestâ€},
{name:â€œPike Push-Upâ€,muscles:â€œShouldersâ€},
{name:â€œInverted Rowâ€,muscles:â€œBack, Bicepsâ€},
{name:â€œBulgarian Split Squatâ€,muscles:â€œQuads, Glutesâ€},
{name:â€œPistol Squatâ€,muscles:â€œQuads, Balanceâ€},
{name:â€œNordic Hamstring Curlâ€,muscles:â€œHamstrings, Eccentricâ€},
{name:â€œGlute Ham Raiseâ€,muscles:â€œHamstrings, Glutesâ€},
{name:â€œGHD Hip Extensionâ€,muscles:â€œPosterior Chainâ€},
{name:â€œMuscle-Upâ€,muscles:â€œFull Upper Bodyâ€},
]},
{cat:â€œCoreâ€,items:[
{name:â€œPlankâ€,muscles:â€œCore, Stabilityâ€},
{name:â€œSide Plankâ€,muscles:â€œObliques, Coreâ€},
{name:â€œCopenhagen Plankâ€,muscles:â€œAdductors, Coreâ€},
{name:â€œDead Bugâ€,muscles:â€œCore, Anti-Extensionâ€},
{name:â€œPallof Pressâ€,muscles:â€œCore, Anti-Rotationâ€},
{name:â€œAb Wheel Rolloutâ€,muscles:â€œCore, Latsâ€},
{name:â€œHanging Knee Raiseâ€,muscles:â€œLower Abs, Hip Flexorsâ€},
{name:â€œHanging Leg Raiseâ€,muscles:â€œAbs, Hip Flexorsâ€},
{name:â€œL-Sit Holdâ€,muscles:â€œCore, Hip Flexorsâ€},
{name:â€œDragon Flagâ€,muscles:â€œCore, Full Body Tensionâ€},
{name:â€œHollow Body Rockâ€,muscles:â€œCore Enduranceâ€},
{name:â€œGHD Sit-Upâ€,muscles:â€œHip Flexors, Coreâ€},
{name:â€œCable Crunchâ€,muscles:â€œAbsâ€},
{name:â€œRussian Twistâ€,muscles:â€œObliquesâ€},
{name:â€œWeighted Plankâ€,muscles:â€œCore, Stabilityâ€},
{name:â€œSuitcase Carryâ€,muscles:â€œCore, Anti-Lateralâ€},
{name:â€œFarmerâ€™s Carryâ€,muscles:â€œGrip, Core, Trapsâ€},
]},
{cat:â€œPlyometric & Explosiveâ€,items:[
{name:â€œBox Jumpâ€,muscles:â€œQuads, Glutes, Powerâ€},
{name:â€œBroad Jumpâ€,muscles:â€œFull Lower Body, Powerâ€},
{name:â€œDepth Jumpâ€,muscles:â€œReactive Power, Legsâ€},
{name:â€œMed Ball Slamâ€,muscles:â€œCore, Lats, Powerâ€},
{name:â€œMed Ball Throwâ€,muscles:â€œCore, Upper Body Powerâ€},
{name:â€œKettlebell Swingâ€,muscles:â€œHips, Glutes, Coreâ€},
{name:â€œKettlebell Clean & Pressâ€,muscles:â€œFull Bodyâ€},
{name:â€œKettlebell Snatchâ€,muscles:â€œFull Body, Conditioningâ€},
{name:â€œBattle Ropeâ€,muscles:â€œConditioning, Shouldersâ€},
{name:â€œSprintâ€,muscles:â€œFull Body, Powerâ€},
{name:â€œBox Squatâ€,muscles:â€œQuads, Glutes, Powerâ€},
]},
{cat:â€œConditioning & Carriesâ€,items:[
{name:â€œSled Pushâ€,muscles:â€œLegs, Conditioningâ€},
{name:â€œSled Pull / Dragâ€,muscles:â€œPosterior Chain, Conditioningâ€},
{name:â€œProwler Sprintâ€,muscles:â€œFull Body, Powerâ€},
{name:â€œTyre Flipâ€,muscles:â€œFull Body, Gripâ€},
{name:â€œLoaded Carry Medleyâ€,muscles:â€œGrip, Core, Full Bodyâ€},
{name:â€œFarmerâ€™s Walkâ€,muscles:â€œGrip, Traps, Coreâ€},
{name:â€œOverhead Carryâ€,muscles:â€œShoulders, Coreâ€},
{name:â€œAssault Bikeâ€,muscles:â€œFull Body Cardioâ€},
{name:â€œRowing Machineâ€,muscles:â€œFull Body Cardioâ€},
{name:â€œJump Ropeâ€,muscles:â€œCalves, Conditioningâ€},
{name:â€œBurpeesâ€,muscles:â€œFull Body, Conditioningâ€},
]},
];

let addMoveSelectedExercise=null;
let addedExercises=[];

function openAddMovement(){
addMoveSelectedExercise=null;
document.getElementById(â€˜add-move-searchâ€™).value=â€™â€™;
document.getElementById(â€˜add-move-configâ€™).classList.remove(â€˜activeâ€™);
document.getElementById(â€˜add-move-listâ€™).style.display=â€˜blockâ€™;
renderExerciseList(â€™â€™);
document.getElementById(â€˜add-move-overlayâ€™).classList.add(â€˜activeâ€™);
setTimeout(()=>document.getElementById(â€˜add-move-searchâ€™).focus(),200);
}

function closeAddMovement(){
document.getElementById(â€˜add-move-overlayâ€™).classList.remove(â€˜activeâ€™);
}

function backToExerciseList(){
document.getElementById(â€˜add-move-configâ€™).classList.remove(â€˜activeâ€™);
document.getElementById(â€˜add-move-listâ€™).style.display=â€˜blockâ€™;
document.getElementById(â€˜add-move-searchâ€™).focus();
}

function filterExercises(query){renderExerciseList(query);}

function renderExerciseList(query){
const list=document.getElementById(â€˜add-move-listâ€™);list.innerHTML=â€™â€™;
const q=query.toLowerCase().trim();
let anyResults=false;
EXERCISE_DB.forEach(cat=>{
const filtered=cat.items.filter(ex=>!q||ex.name.toLowerCase().includes(q)||ex.muscles.toLowerCase().includes(q));
if(!filtered.length)return;
anyResults=true;
const catDiv=document.createElement(â€˜divâ€™);catDiv.className=â€˜add-move-catâ€™;catDiv.textContent=cat.cat;
list.appendChild(catDiv);
filtered.forEach(ex=>{
const item=document.createElement(â€˜divâ€™);item.className=â€˜add-move-itemâ€™;
item.innerHTML=`<div><div class="add-move-item-name">${ex.name}</div><div class="add-move-item-muscles">${ex.muscles}</div></div><div class="add-move-item-arrow">â†’</div>`;
item.onclick=()=>selectExerciseToAdd(ex);
list.appendChild(item);
});
});
if(!anyResults){
const safeQ=q.replace(/[â€™â€<>&]/g,â€™â€™);
list.innerHTML=`<div style="text-align:center;padding:40px 16px"><div style="font-size:14px;color:var(--text-muted);margin-bottom:16px">No matches found</div></div>`;
const customItem=document.createElement(â€˜divâ€™);customItem.className=â€˜add-move-itemâ€™;
customItem.innerHTML=`<div><div class="add-move-item-name" style="color:var(--accent)">+ Add "${safeQ}" as custom</div><div class="add-move-item-muscles">Custom exercise</div></div><div class="add-move-item-arrow">â†’</div>`;
customItem.onclick=()=>selectExerciseToAdd({name:safeQ,muscles:â€˜Customâ€™});
list.querySelector(â€˜divâ€™).appendChild(customItem);
}
}

function selectExerciseToAdd(ex){
addMoveSelectedExercise=ex;
document.getElementById(â€˜add-move-config-titleâ€™).textContent=ex.name;
document.getElementById(â€˜add-move-setsâ€™).value=â€˜3â€™;
document.getElementById(â€˜add-move-repsâ€™).value=â€˜10â€™;
document.getElementById(â€˜add-move-restâ€™).value=â€˜90sâ€™;
document.getElementById(â€˜add-move-noteâ€™).value=â€™â€™;
document.getElementById(â€˜add-move-listâ€™).style.display=â€˜noneâ€™;
document.getElementById(â€˜add-move-configâ€™).classList.add(â€˜activeâ€™);
}

function confirmAddMovement(){
if(!addMoveSelectedExercise)return;
const sets=parseInt(document.getElementById(â€˜add-move-setsâ€™).value)||3;
const reps=document.getElementById(â€˜add-move-repsâ€™).value||â€˜10â€™;
const rest=document.getElementById(â€˜add-move-restâ€™).value||â€˜90sâ€™;
const note=document.getElementById(â€˜add-move-noteâ€™).value||â€˜Added during workoutâ€™;
const ex=E(addMoveSelectedExercise.name,sets,reps,rest,note);
addedExercises.push(ex);
// Add to the workout content
appendExerciseToWorkout(ex);
closeAddMovement();
updateProgress();
}

function appendExerciseToWorkout(ex){
const content=document.getElementById(â€˜workout-contentâ€™);
// Remove the add button temporarily to append exercise before it
const addBtn=document.getElementById(â€˜add-movement-btnâ€™);
const exIdx=getNextExerciseIndex();
const rpeOpts=[6,7,8,9,10].map(v=>`<option value="${v}">${v}</option>`).join(â€™â€™);
const exDiv=document.createElement(â€˜divâ€™);exDiv.className=â€˜exercise-itemâ€™;exDiv.id=`ex-${exIdx}`;
exDiv.setAttribute(â€˜data-addedâ€™,â€˜trueâ€™);
let setsHTML=â€™â€™;const numSets=ex.sets||1;
for(let s=0;s<numSets;s++){
setsHTML+=`<div class="log-set-row"><div class="set-num">S${s+1}</div><div class="log-input-wrap"><div class="log-input-label">WEIGHT (lbs)</div><input type="number" class="log-input" id="w-${exIdx}-${s}" placeholder="â€”" oninput="onInputChange(${exIdx},${s})" onfocus="this.select()"></div><div class="rpe-wrap"><div class="log-input-label">RPE</div><select class="rpe-select" id="r-${exIdx}-${s}" onchange="onInputChange(${exIdx},${s})"><option value="">â€”</option>${rpeOpts}</select></div><button class="set-check" id="chk-${exIdx}-${s}" onclick="toggleSetDone(${exIdx},${s})">â—‹</button></div>`;
}
exDiv.innerHTML=`<div class="exercise-header"><div class="exercise-name" onclick="showExHistory('${ex.name.replace(/'/g,"\\'")}')">${ex.name}</div><div style="font-size:9px;font-weight:700;letter-spacing:2px;color:var(--accent);border:1px solid var(--accent);padding:2px 6px;border-radius:3px;text-transform:uppercase;white-space:nowrap;margin-top:5px">ADDED</div></div><div class="exercise-specs"><div><div class="spec-label">Sets</div><div class="spec-val">${ex.sets||'â€”'}</div></div><div><div class="spec-label">Reps</div><div class="spec-val">${ex.reps}</div></div><div><div class="spec-label">Rest</div><div class="spec-val">${ex.rest}</div></div></div><div class="exercise-note">${ex.note}</div><div class="log-sets">${setsHTML}</div>`;
if(addBtn){content.insertBefore(exDiv,addBtn);}
else{content.appendChild(exDiv);}
}

function getNextExerciseIndex(){
let max=-1;
document.querySelectorAll(â€™#workout-content .exercise-itemâ€™).forEach(el=>{
const id=el.id;if(id&&id.startsWith(â€˜ex-â€™)){const n=parseInt(id.replace(â€˜ex-â€™,â€™â€™));if(n>max)max=n;}
});
return max+1;
}

async function init(){
await loadState();
document.getElementById(â€˜start-date-inputâ€™).value=new Date().toISOString().split(â€˜Tâ€™)[0];
// Safari fix: blur date input after selection to ensure button is tappable
document.getElementById(â€˜start-date-inputâ€™).addEventListener(â€˜changeâ€™,function(){this.blur();});
// Backup click handler via addEventListener (Safari can drop onclick after date picker)
document.getElementById(â€˜btn-beginâ€™).addEventListener(â€˜clickâ€™,setupPlan);
document.getElementById(â€˜btn-beginâ€™).addEventListener(â€˜touchendâ€™,function(e){e.preventDefault();setupPlan();});
if(state.startDate){initHomeScreen();goTo(â€˜home-screenâ€™);document.getElementById(â€˜bottom-navâ€™).classList.add(â€˜visibleâ€™);document.getElementById(â€˜nav-homeâ€™).classList.add(â€˜activeâ€™);}
document.addEventListener(â€˜focusâ€™,function(e){
if(e.target.tagName===â€˜INPUTâ€™||e.target.tagName===â€˜SELECTâ€™){
setTimeout(()=>{e.target.scrollIntoView({behavior:â€˜smoothâ€™,block:â€˜centerâ€™});},300);
}
},true);
}
init();
</script></body></html>